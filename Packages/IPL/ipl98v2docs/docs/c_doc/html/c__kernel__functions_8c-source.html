<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link type="text/css" href="../../doxygen.css" rel="stylesheet">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Image Processing Library 98</title>
</head>

<body>
<h2 align="center"><a href="http://www.mip.sdu.dk/ipl98" target="_blank"><img border="0" src="ipl_doc_header.gif" width="694" height="55"></a></h2>

</body>

</html>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; </center>
<hr><h1>c_kernel_functions.c</h1><div class="fragment"><pre>00001 <span class="comment">/********************************************************************</span>
00002 <span class="comment">   The Image Processing Library 98 - IPL98</span>
00003 <span class="comment">   Copyright (C) by René Dencker Eriksen - edr@mip.sdu.dk</span>
00004 <span class="comment"></span>
00005 <span class="comment">   This library is free software; you can redistribute it and/or</span>
00006 <span class="comment">   modify it under the terms of the GNU Lesser General Public</span>
00007 <span class="comment">   License as published by the Free Software Foundation. Only</span>
00008 <span class="comment">   addition is, that if the library is used in proprietary software</span>
00009 <span class="comment">   it must be stated that IPL98 was used.</span>
00010 <span class="comment"></span>
00011 <span class="comment">   This library is distributed in the hope that it will be useful,</span>
00012 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00013 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
00014 <span class="comment"></span>
00015 <span class="comment">   More details can be found in the file licence.txt distributed</span>
00016 <span class="comment">   with this library.</span>
00017 <span class="comment">*********************************************************************/</span>
00018 
00019 <span class="preprocessor">#include "c_kernel_functions.h"</span>
00020 <span class="preprocessor">#include "../kernel_string.h"</span>
00021 <span class="preprocessor">#include "../kernel_error.h"</span>
00022 <span class="preprocessor">#include "../kernel_pixelgroup.h"</span>
00023 <span class="preprocessor">#include "../kernel_history.h"</span>
00024 <span class="preprocessor">#include "../algorithms/kernel_graphics.h"</span>
00025 <span class="preprocessor">#include &lt;string.h&gt;</span>
00026 
00027 <span class="preprocessor">#ifdef _IPL98_USING_CPP</span>
00028 <span class="preprocessor"></span><span class="keyword">namespace </span>ipl{ <span class="comment">/* use namespace if C++ */</span>
00029 <span class="keyword">extern</span> <span class="stringliteral">"C"</span> { <span class="comment">/* prevent name mangling for C functions */</span>
00030 <span class="preprocessor">#endif</span>
00031 <span class="preprocessor"></span>
00032 <span class="comment">/****************************************/</span>
00033 <span class="comment">/*           Private functions          */</span>
00034 <span class="comment">/****************************************/</span>
00035 
00036 <span class="keywordtype">void</span> kC_SetImageMatrix(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo);
00037 <span class="comment">/* returns the size of a scanline, no. zero padding in a float image */</span>
00038 <a class="code" href="group__valuetypes.html#a5">UINT32</a> kC_GetSizeScanLine(<a class="code" href="group__valuetypes.html#a5">UINT32</a> Width);
00039 <span class="keywordtype">bool</span> kC_LoadComplex(FILE* fp,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo);
00040 <span class="keywordtype">bool</span> kC_SaveComplex(FILE* fp,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo);
00041 
00042 <span class="comment">/****************************************/</span>
00043 <span class="comment">/*           Public functions           */</span>
00044 <span class="comment">/****************************************/</span>
00045 
<a name="l00046"></a><a class="code" href="group__compleximage.html#a0">00046</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00047 {
00048         <a class="code" href="group__filefunctions.html#a1">k_EmptyFileInfo</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00049         <a class="code" href="group__ipltext.html#a1">k_EmptyText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00050         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>!=NULL)
00051         {
00052                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>);
00053                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=NULL;
00054         }
00055         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>!=NULL)
00056         {
00057                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>);
00058                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=NULL;
00059         }
00060         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>!=NULL)
00061         {
00062                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>);
00063                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>=NULL;
00064         }
00065     <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>!=NULL)
00066         {
00067                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>);
00068                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>=NULL;
00069         }
00070         pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>=0;
00071         pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>=0;
00072         pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>=0;
00073         pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>=0;
00074         pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>=0;
00075         pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>=0;
00076         pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>=0;
00077         pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=EMPTY;
00078 }
00079 
<a name="l00080"></a><a class="code" href="group__compleximage.html#a1">00080</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00081 {
00082         <a class="code" href="group__filefunctions.html#a0">k_InitFileInfo</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00083         <a class="code" href="group__ipltext.html#a0">k_InitText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00084         pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=NULL;
00085         pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=NULL;
00086         pInfo-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>=NULL;
00087         pInfo-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>=NULL;
00088         pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>=NULL;
00089         pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>=NULL;
00090         pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=EMPTY;
00091         pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>=0; <span class="comment">/* default origo (0,0) */</span>
00092         pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>=0;
00093 }
00094 
<a name="l00095"></a><a class="code" href="group__compleximage.html#a2">00095</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(<a class="code" href="group__valuetypes.html#a5">UINT32</a> Width, <a class="code" href="group__valuetypes.html#a5">UINT32</a> Height,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00096 {
00097         <span class="keywordflow">if</span>(pInfo!=NULL)
00098         {
00099                 <span class="comment">/* start with emptying the old image data (if any!) */</span>
00100                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
00101                 <span class="comment">/* set values in the image info structure */</span>
00102                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=RAM;
00103                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>=Width;
00104                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>=Height;
00105                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>=0; <span class="comment">/* always 0 for a new image */</span>
00106                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>=0;
00107                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>=0;
00108                 <span class="comment">/* calculate size and width (incl zero-padding) of image */</span>
00109                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>=(UINT16) kC_GetSizeScanLine(Width);
00110                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a> = pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a> * Height; <span class="comment">/* no compression */</span>
00111                 <span class="comment">/* Allocate memory for image */</span>
00112                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) calloc(<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>),pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>/<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>));
00113                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) calloc(<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>),pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>/<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>));
00114                 kC_SetImageMatrix(pInfo);
00115                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00116         }
00117         <span class="keywordflow">else</span>
00118         {
00119                 <a class="code" href="structTString.html">TString</a> str;
00120                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00121                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00122                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_AllocImage() pInfo is a NULL pointer"</span>);
00123                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00124                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00125         }
00126 }
00127 
<a name="l00128"></a><a class="code" href="group__compleximage.html#a3">00128</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a3">kC_AllocImageFast</a>(<a class="code" href="group__valuetypes.html#a5">UINT32</a> Width, <a class="code" href="group__valuetypes.html#a5">UINT32</a> Height,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00129 {
00130         <span class="keywordflow">if</span>(pInfo!=NULL)
00131         {
00132                 <span class="comment">/* start with emptying the old image data (if any!) */</span>
00133                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
00134                 <span class="comment">/* set values in the image info structure */</span>
00135                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=RAM;
00136                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>=Width;
00137                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>=Height;
00138                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>=0; <span class="comment">/* always 0 for a new image */</span>
00139                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>=0;
00140                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>=0;
00141                 <span class="comment">/* calculate size and width (incl zero-padding) of image */</span>
00142                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>=(UINT16) kC_GetSizeScanLine(Width);
00143                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a> = pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a> * Height; <span class="comment">/* no compression */</span>
00144                 <span class="comment">/* Allocate memory for image */</span>
00145                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00146                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00147                 kC_SetImageMatrix(pInfo);
00148                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00149         }
00150         <span class="keywordflow">else</span>
00151         {
00152                 <a class="code" href="structTString.html">TString</a> str;
00153                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00154                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00155                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_AllocImageFast() pInfo is a NULL pointer"</span>);
00156                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00157                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00158         }
00159 }
00160 
<a name="l00161"></a><a class="code" href="group__compleximage.html#a4">00161</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a4">kC_FlushImage</a>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pDest)
00162 {
00163         <span class="keywordtype">int</span> y,x;
00164         <span class="keywordflow">if</span> (pDest==NULL)
00165         {
00166                 <a class="code" href="structTString.html">TString</a> str;
00167                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00168                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00169                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_FlushImage() pDest is a NULL pointer"</span>);
00170                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00171                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00172         }
00173         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDest-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00174         {
00175                 <a class="code" href="structTString.html">TString</a> str;
00176                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00177                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00178                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_FlushImage() Image is empty - doing nothing"</span>);
00179                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00180                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00181         }
00182         <span class="keywordflow">else</span>
00183         {
00184 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00185 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
00186                 {
00187                         <a class="code" href="structTString.html">TString</a> History;
00188                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00189                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_FlushImage(Re=%f Im=%f)"</span>,ipl_HistoryIndent,Re,Im);
00190                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00191                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00192                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00193                 }
00194 <span class="preprocessor">#endif</span>
00195 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;(int)pDest-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
00196                         <span class="keywordflow">for</span> (x=0;x&lt;(int)pDest-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
00197                         {
00198                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,y,Re,*pDest);
00199                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,y,Im,*pDest);
00200                         }
00201 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00202 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00203                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00204 <span class="preprocessor">#endif</span>
00205 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
00206         }
00207 }
00208 
<a name="l00209"></a><a class="code" href="group__compleximage.html#a5">00209</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a5">kC_Load</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* FileName, <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00210 {
00211         <span class="keywordtype">bool</span> returnValue;
00212         FILE* fp;
00213         <span class="keywordtype">char</span>* Path=NULL,*FileNameExt=NULL,*Ext=NULL;
00214         <span class="keywordflow">if</span> (!<a class="code" href="group__filefunctions.html#a14">k_SplitFileName</a>(FileName, &amp;Path,&amp;FileNameExt,&amp;Ext))
00215         {
00216                 <a class="code" href="structTString.html">TString</a> str;
00217                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00218                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00219                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Load() Filename not valid"</span>);
00220                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00221                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00222         }
00223         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(Ext,<span class="stringliteral">""</span>)==0)
00224         {
00225                 <a class="code" href="structTString.html">TString</a> str;
00226                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00227                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00228                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Load() No extension found"</span>);
00229                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00230                 returnValue=<span class="keyword">false</span>;
00231         }
00232         <span class="keywordflow">else</span>
00233         {
00234                 returnValue=<span class="keyword">true</span>;
00235                 <a class="code" href="group__string.html#a13">k_StringToUpper</a>(Ext);
00236                 fp=fopen(FileName,<span class="stringliteral">"rb"</span>);  <span class="comment">/* open file */</span>
00237                 <span class="keywordflow">if</span> (fp==NULL)
00238                 {
00239                         <a class="code" href="structTString.html">TString</a> str;
00240                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00241                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00242                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Load() Could not open file"</span>);
00243                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00244                         returnValue=<span class="keyword">false</span>;
00245                 }
00246                 <span class="keywordflow">else</span>
00247                 {
00248                         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
00249                         <span class="comment">/* read from file */</span>
00250                         returnValue=kC_LoadComplex(fp,pInfo);
00251                 }
00252 
00253                 <span class="keywordflow">if</span> (returnValue==<span class="keyword">true</span>)
00254                 {
00255                         pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=DISC;
00256                         <span class="comment">/* set file and path name */</span>
00257                         <a class="code" href="group__filefunctions.html#a13">k_SetFileAndPath</a>(FileName,&amp;pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>);
00258                         <span class="comment">/* update file information in the history */</span>
00259                         <a class="code" href="group__ipltext.html#a12">k_SetFileInfoFromPathFileText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>);
00260 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00261 <span class="preprocessor"></span>                        <span class="comment">/* add comment to history */</span>
00262                         {
00263                                 <a class="code" href="structTString.html">TString</a> History;
00264                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00265                                 <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Load(%s)"</span>,ipl_HistoryIndent,FileName);
00266                                 <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00267                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00268                         }
00269 <span class="preprocessor">#endif</span>
00270 <span class="preprocessor"></span>                }
00271                 <span class="keywordflow">if</span> (fp!=NULL)
00272                 {
00273                         fclose(fp);
00274                 }
00275         }
00276         free(Path);
00277         free(FileNameExt);
00278         free(Ext);
00279         <span class="keywordflow">return</span> returnValue;
00280 }
00281 
<a name="l00282"></a><a class="code" href="group__compleximage.html#a6">00282</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a6">kC_Save</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* FileName, <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00283 {
00284         <span class="keywordtype">bool</span> returnValue;
00285         FILE* fp;
00286         <span class="keywordtype">char</span>* Path=NULL,*FileNameExt=NULL,*Ext=NULL;
00287         <span class="keywordflow">if</span> (!<a class="code" href="group__filefunctions.html#a14">k_SplitFileName</a>(FileName, &amp;Path,&amp;FileNameExt,&amp;Ext))
00288         {
00289                 <a class="code" href="structTString.html">TString</a> str;
00290                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00291                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00292                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Save() Filename not valid"</span>);
00293                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00294                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00295         }
00296         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(Ext,<span class="stringliteral">""</span>)==0)
00297         {
00298                 <a class="code" href="structTString.html">TString</a> str;
00299                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00300                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00301                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Save() No extension found"</span>);
00302                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00303                 returnValue=<span class="keyword">false</span>;
00304         }
00305         <span class="keywordflow">else</span>
00306         {
00307                 returnValue=<span class="keyword">true</span>;
00308                 <a class="code" href="group__string.html#a13">k_StringToUpper</a>(Ext);
00309                 fp=fopen(FileName,<span class="stringliteral">"wb"</span>); <span class="comment">/* open file */</span>
00310                 <span class="keywordflow">if</span> (fp==NULL)
00311                 {
00312                         <a class="code" href="structTString.html">TString</a> str;
00313                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00314                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00315                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Save() Could not save file"</span>);
00316                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00317                         returnValue=<span class="keyword">false</span>;
00318                 }
00319                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00320                 {
00321                         <a class="code" href="structTString.html">TString</a> str;
00322                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00323                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00324                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Save() No image - cannot save"</span>);
00325                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00326                         returnValue=<span class="keyword">false</span>;
00327                 }
00328                 <span class="keywordflow">else</span>
00329                 {
00330                         <span class="comment">/* Save image */</span>
00331 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00332 <span class="preprocessor"></span>                        <span class="comment">/* add comment to history */</span>
00333                         {
00334                                 <a class="code" href="structTString.html">TString</a> History;
00335                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00336                                 <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Save(%s)"</span>,ipl_HistoryIndent,FileName);
00337                                 <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00338                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00339                         }
00340 <span class="preprocessor">#endif</span>
00341 <span class="preprocessor"></span>                        returnValue=kC_SaveComplex(fp,pInfo);
00342                 }
00343                 <span class="keywordflow">if</span> (returnValue==<span class="keyword">true</span>)
00344                 {
00345                         pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=DISC;
00346                         <span class="comment">/* empty file information before proceeding */</span>
00347                         <a class="code" href="group__filefunctions.html#a1">k_EmptyFileInfo</a>(&amp;pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>);
00348                         <span class="comment">/* set file and path name */</span>
00349                         pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m0">FileName</a> = (<span class="keywordtype">char</span> *) malloc(strlen(FileNameExt)+1);
00350                         strcpy(pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m0">FileName</a>,FileNameExt);
00351                         pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m1">PathName</a> = (<span class="keywordtype">char</span> *) malloc(strlen(Path)+1);
00352                         strcpy(pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m1">PathName</a>,Path);
00353                         pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a> = (<span class="keywordtype">char</span> *) malloc(strlen(FileName)+1);
00354                         strcpy(pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>,FileName);
00355                         <span class="comment">/* update file information in the history */</span>
00356                         <a class="code" href="group__ipltext.html#a12">k_SetFileInfoFromPathFileText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>);
00357                 }
00358                 <span class="keywordflow">else</span>
00359                 {
00360 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00361 <span class="preprocessor"></span>                        <span class="comment">/* remove last line added to history */</span>
00362                         <a class="code" href="group__ipltext.html#a16">k_RemoveLastLineText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00363 <span class="preprocessor">#endif</span>
00364 <span class="preprocessor"></span>                }
00365                 <span class="keywordflow">if</span> (fp!=NULL)
00366                 {
00367                         fclose(fp);
00368                 }
00369         }
00370         free(Path);
00371         free(FileNameExt);
00372         free(Ext);
00373         <span class="keywordflow">return</span> returnValue;
00374 }
00375 
<a name="l00376"></a><a class="code" href="group__compleximage.html#a7">00376</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a7">kC_SetBorder</a>(<a class="code" href="group__valuetypes.html#a3">UINT16</a> Size, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im, <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00377 {
00378         <a class="code" href="group__compleximage.html#a8">kC_SetBorderSize</a>(Size,pInfo);
00379         <a class="code" href="group__compleximage.html#a9">kC_SetBorderColor</a>(Re, Im,pInfo);
00380         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00381 }
00382 
<a name="l00383"></a><a class="code" href="group__compleximage.html#a8">00383</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a8">kC_SetBorderSize</a>(<a class="code" href="group__valuetypes.html#a3">UINT16</a> Size, <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00384 {
00385         <a class="code" href="group__valuetypes.html#a5">UINT32</a> realX,realY,offset;
00386         <a class="code" href="group__valuetypes.html#a5">UINT32</a> UINT32Value; <span class="comment">/* temporary variable */</span>
00387         <a class="code" href="group__valuetypes.html#a6">FLOAT32</a>* pNewImageRe, *pNewImageIm; <span class="comment">/* variables pointing to new allocated image area */</span>
00388         <a class="code" href="group__valuetypes.html#a5">UINT32</a> i;
00389         <a class="code" href="group__valuetypes.html#a5">UINT32</a> SmallestByteWidth;
00390         
00391         realX=pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+2*Size; <span class="comment">/* width of image + border */</span>
00392         realY=pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+2*Size; <span class="comment">/* height of image + border */</span>
00393         <span class="comment">/* calculate size and width (incl zero-padding) of image + border */</span>
00394         UINT32Value=kC_GetSizeScanLine(realX);
00395         <span class="comment">/* Only copy memory area for the shortest width of the destination and source image */</span>
00396         SmallestByteWidth=UINT32Value&lt;(UINT32)pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>?UINT32Value:pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>;
00397         pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>=Size;
00398         pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>=(UINT16) UINT32Value;
00399         pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>=(UINT16) UINT32Value*(realY);
00400         <span class="comment">/* Allocate memory for image */</span>
00401         pNewImageRe=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00402         pNewImageIm=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00403         offset=pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>-1+Size;
00404         UINT32Value /= <span class="keyword">sizeof</span>(FLOAT32);
00405         <span class="keywordflow">for</span>(i=Size;i&lt;Size+pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;i++)
00406         {
00407                 memcpy(pNewImageRe+Size+i*UINT32Value,(pInfo-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>)[offset-i],SmallestByteWidth);
00408                 memcpy(pNewImageIm+Size+i*UINT32Value,(pInfo-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>)[offset-i],SmallestByteWidth);
00409         }
00410         free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>); <span class="comment">/* release old image area */</span>
00411         free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>); <span class="comment">/* release old image area */</span>
00412         pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=pNewImageRe;
00413         pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=pNewImageIm;
00414         kC_SetImageMatrix(pInfo);
00415         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00416 }
00417 
<a name="l00418"></a><a class="code" href="group__compleximage.html#a9">00418</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a9">kC_SetBorderColor</a>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im, <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00419 {
00420         <a class="code" href="group__valuetypes.html#a3">UINT16</a> borderSize=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
00421         <span class="keywordtype">int</span> i,j;
00422         <span class="comment">/* Set upper border */</span>
00423         <span class="keywordflow">for</span>(i=-borderSize;i&lt;0;i++)
00424         {
00425                 <span class="keywordflow">for</span>(j=-borderSize; j&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+borderSize; j++)
00426                 {
00427                         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(j,i,Re,(*pInfo));
00428                         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(j,i,Im,(*pInfo));
00429                 }
00430         }
00431         <span class="keywordflow">for</span>(i=0;i&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;i++)
00432         {
00433                 <span class="keywordflow">for</span>(j=0;j&lt;borderSize;j++)
00434                 {
00435                         <span class="comment">/* Set left and right border */</span>
00436                         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(j-borderSize,i,Re,(*pInfo));
00437                         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+j,i,Im,(*pInfo));
00438                 }
00439         }
00440         <span class="comment">/* Set lower border */</span>
00441         <span class="keywordflow">for</span>(i=pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;i&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+borderSize;i++)
00442         {
00443                 <span class="keywordflow">for</span>(j=-borderSize; j&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+borderSize; j++)
00444                 {
00445                         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(j,i,Re,(*pInfo));
00446                         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(j,i,Im,(*pInfo));
00447                 }
00448         }
00449         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00450 }
00451 
<a name="l00452"></a><a class="code" href="group__compleximage.html#a10">00452</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a10">kC_SetPeriodicBorder</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> BorderSize,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
00453 {
00454         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00455         {
00456                 <a class="code" href="structTString.html">TString</a> str;
00457                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00458                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00459                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_SetPeriodicBorder() Image is empty"</span>);
00460                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00461                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00462         }
00463         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)BorderSize&gt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>) || ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)BorderSize&gt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>))
00464         {
00465                 <a class="code" href="structTString.html">TString</a> str;
00466                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00467                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00468                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_SetPeriodicBorder() Border too large"</span>);
00469                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00470                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00471         }
00472         <span class="keywordflow">else</span>
00473         {
00474                 <span class="keywordtype">int</span> x,y;
00475                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w,h;
00476                 w=pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
00477                 h=pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
00478                 <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>!=BorderSize) <span class="comment">/* only set border if necessary */</span>
00479                         <a class="code" href="group__compleximage.html#a8">kC_SetBorderSize</a>(BorderSize,pInfo);
00480                 <span class="comment">/* setting upper and lover horisontal border values */</span>
00481                 <span class="keywordflow">for</span>(y=1;y&lt;=BorderSize;y++)
00482                 {
00483                         <span class="keywordflow">for</span>(x=0;x&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
00484                         {
00485                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,-y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,h-y,*pInfo),*pInfo); <span class="comment">/* setting upper border */</span>
00486                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,h+y-1,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y-1,*pInfo),*pInfo); <span class="comment">/* setting lower border */</span>
00487                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,-y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,h-y,*pInfo),*pInfo); <span class="comment">/* setting upper border */</span>
00488                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,h+y-1,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y-1,*pInfo),*pInfo); <span class="comment">/* setting lower border */</span>
00489                         }
00490                 }
00491                 <span class="comment">/* setting left and right vertical border values */</span>
00492                 <span class="keywordflow">for</span>(x=1;x&lt;=BorderSize;x++)
00493                 {
00494                         <span class="keywordflow">for</span>(y=0;y&lt;(int)pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
00495                         {
00496                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(-x,y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(w-x,y,*pInfo),*pInfo); <span class="comment">/* setting left border */</span>
00497                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(w+x-1,y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x-1,y,*pInfo),*pInfo); <span class="comment">/* setting right border */</span>
00498                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(-x,y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(w-x,y,*pInfo),*pInfo); <span class="comment">/* setting left border */</span>
00499                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(w+x-1,y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x-1,y,*pInfo),*pInfo); <span class="comment">/* setting right border */</span>
00500                         }
00501                 }
00502                 <span class="comment">/* setting the four corners */</span>
00503                 <span class="keywordflow">for</span>(y=1;y&lt;=BorderSize;y++)
00504                 {
00505                         <span class="keywordflow">for</span>(x=1;x&lt;=BorderSize;x++)
00506                         {
00507                                 <span class="comment">/* setting top left corner */</span>
00508                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(-x,-y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(w-x,h-y,*pInfo),*pInfo);
00509                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(-x,-y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(w-x,h-y,*pInfo),*pInfo);
00510                                 <span class="comment">/* setting top right corner */</span>
00511                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(w+x-1,-y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(-x,h+y-1,*pInfo),*pInfo);
00512                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(w+x-1,-y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(-x,h+y-1,*pInfo),*pInfo);
00513                                 <span class="comment">/* setting bottom left corner */</span>
00514                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(-x,h+y-1,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(w-x,y-1,*pInfo),*pInfo);
00515                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(-x,h+y-1,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(w-x,y-1,*pInfo),*pInfo);
00516                                 <span class="comment">/* setting bottom right corner */</span>
00517                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(w+x-1,h+y-1,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x-1,y-1,*pInfo),*pInfo);
00518                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(w+x-1,h+y-1,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x-1,y-1,*pInfo),*pInfo);
00519                         }
00520                 }
00521                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00522         }
00523 }
00524 
<a name="l00525"></a><a class="code" href="group__compleximage.html#a11">00525</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a11">kC_CopyImage</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pDest,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pSource)
00526 {
00527         <span class="keywordflow">if</span> (pDest==pSource)
00528         {
00529                 <span class="comment">/* cannot copy to itself! */</span>
00530                 <a class="code" href="structTString.html">TString</a> str;
00531                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00532                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00533                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopyImage() Source and destination image"</span>
00534                         <span class="stringliteral">"the same - doing nothing"</span>);
00535                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00536                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00537         }
00538         <span class="comment">/* Allocate memory if necessary */</span>
00539         <span class="keywordflow">if</span> ((pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>!=pSource-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>) || (pDest-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>!=pSource-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>))
00540         {
00541                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pDest);
00542                 pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a> = pSource-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>;
00543                 pDest-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
00544                 pDest-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00545                 pDest-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>=(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*) malloc(pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00546                 pDest-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
00547                 pDest-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
00548                 kC_SetImageMatrix(pDest);
00549         }
00550         pDest-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=RAM;
00551         pDest-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
00552         pDest-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
00553         pDest-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>;
00554         pDest-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>;
00555         <span class="keywordflow">if</span> (pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY)
00556         {
00557 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00558 <span class="preprocessor"></span>                <span class="comment">/* copy history before adding comment */</span>
00559                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00560                 <span class="comment">/* add comment to history */</span>
00561                 {
00562                         <a class="code" href="structTString.html">TString</a> History;
00563                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00564                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyImage() Source image file info: %s"</span>
00565                                 ,ipl_HistoryIndent,pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>);
00566                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00567                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00568                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00569                 }
00570 <span class="preprocessor">#endif</span>
00571 <span class="preprocessor"></span>                <span class="comment">/* copy file information */</span>
00572                 <a class="code" href="group__filefunctions.html#a2">k_CopyFileInfo</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00573                 <span class="comment">/* copy image data */</span>
00574                 memcpy(pDest-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>,pSource-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>,pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00575                 memcpy(pDest-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>,pSource-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>,pDest-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
00576 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00577 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00578                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00579 <span class="preprocessor">#endif</span>
00580 <span class="preprocessor"></span>        }
00581         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00582 }
00583 
<a name="l00584"></a><a class="code" href="group__compleximage.html#a12">00584</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a12">kC_CopySubImage</a>(<span class="keywordtype">int</span> xmin,<span class="keywordtype">int</span> ymin,<span class="keywordtype">int</span> xmax,<span class="keywordtype">int</span> ymax,
00585                                          <a class="code" href="structTComplexImage.html">TComplexImage</a>* pDest,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pSource)
00586 {
00587         <a class="code" href="structTComplexImage.html">TComplexImage</a>* pTarget=pDest;
00588         <span class="keywordtype">bool</span> CopyToSource=<span class="keyword">false</span>;
00589         <span class="keywordflow">if</span> (pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00590         {
00591                 <a class="code" href="structTString.html">TString</a> str;
00592                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00593                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00594                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_CopySubImage() Source image is empty - doing nothing"</span>);
00595                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00596                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00597         }
00598         <span class="comment">/* Check if the source and destination is the same image */</span>
00599         <span class="keywordflow">if</span> (pDest==pSource)
00600         {
00601                 pTarget=(<a class="code" href="structTComplexImage.html">TComplexImage</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structTComplexImage.html">TComplexImage</a>));
00602                 <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(pTarget);
00603                 CopyToSource=<span class="keyword">true</span>;
00604         }
00605         <span class="comment">/* Not optimised regarding speed! */</span>
00606         <span class="keywordflow">if</span> ((xmin&lt;xmax) &amp;&amp; (ymin&lt;ymax) &amp;&amp;
00607                 (xmin&gt;=<a class="code" href="group__compleximage.html#a16">kC_GetMinX</a>(pSource)) &amp;&amp; (ymin&gt;=<a class="code" href="group__compleximage.html#a17">kC_GetMinY</a>(pSource)) &amp;&amp;
00608                 (xmax&lt;=<a class="code" href="group__compleximage.html#a18">kC_GetMaxX</a>(pSource)) &amp;&amp; (ymax&lt;=<a class="code" href="group__compleximage.html#a19">kC_GetMaxY</a>(pSource)))
00609         {
00610                 <a class="code" href="group__valuetypes.html#a3">UINT16</a> xdim,ydim;
00611                 <span class="keywordtype">int</span> i;
00612                 <span class="keywordtype">int</span> xminNoOrigo=xmin+pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
00613                 <span class="keywordtype">int</span> yminNoOrigo=ymin+pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
00614                 <span class="keywordtype">int</span> ymaxNoOrigo=ymax+pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
00615                 xdim=(UINT16)(xmax-xmin);
00616                 ydim=(UINT16)(ymax-ymin);
00617                 <span class="keywordflow">if</span> (pTarget-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>!=(kC_GetSizeScanLine(xdim)*ydim))
00618                 {
00619                         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pDest);
00620                         <span class="comment">/* prepare destination image */</span>
00621                         <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(xdim,ydim,pDest);
00622                 }
00623                 <a class="code" href="group__filefunctions.html#a2">k_CopyFileInfo</a>(&amp;(pTarget-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00624 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00625 <span class="preprocessor"></span>                <span class="comment">/* copy history before adding comment */</span>
00626                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pTarget-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00627                 <span class="comment">/* add comment to history */</span>
00628                 {
00629                         <a class="code" href="structTString.html">TString</a> History;
00630                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00631                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopySubImage(xmin=%d,ymin=%d,xmax=%d,ymax=%d) Source image file info: %s"</span>
00632                                 ,ipl_HistoryIndent,xmin,ymin,xmax,ymax,pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>);
00633                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pTarget-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00634                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00635                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00636                 }
00637 <span class="preprocessor">#endif</span>
00638 <span class="preprocessor"></span>                <span class="comment">/* copy image pixels */</span>
00639                 <span class="keywordflow">for</span>(i=yminNoOrigo; i&lt;ymaxNoOrigo; i++)
00640                 {
00641                         memcpy(pTarget-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[i-yminNoOrigo],pSource-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[i]+<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>)*xminNoOrigo,xdim*<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>));
00642                         memcpy(pTarget-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[i-yminNoOrigo],pSource-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[i]+<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>)*xminNoOrigo,xdim*<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>));
00643                 }
00644                 pDest-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>=RAM;
00645                 <span class="comment">/* Set origo */</span>
00646                 pDest-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>=pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>;
00647                 <span class="keywordflow">if</span> (CopyToSource==<span class="keyword">true</span>)
00648                 {
00649                         <a class="code" href="group__compleximage.html#a11">kC_CopyImage</a>(pDest,pTarget);
00650                         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pTarget);
00651                         free(pTarget);
00652                 }
00653 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00654 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00655                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00656 <span class="preprocessor">#endif</span>
00657 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
00658         }
00659         <span class="keywordflow">else</span>
00660         {
00661                 <a class="code" href="structTString.html">TString</a> str;
00662                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00663                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00664                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopySubImage() Illegal clipping rectangel"</span>);
00665                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00666                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00667         }
00668 }
00669 
<a name="l00670"></a><a class="code" href="group__compleximage.html#a13">00670</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a13">kC_Rotate90</a>(<span class="keywordtype">int</span> Steps,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pSource)
00671 {
00672         <a class="code" href="structTComplexImage.html">TComplexImage</a> NewImage;
00673         <span class="keywordtype">int</span> x,y;
00674         <span class="keywordtype">int</span> MaxYIndex=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>-1;
00675         <span class="keywordtype">int</span> MaxXIndex=pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>-1;
00676         <span class="keywordtype">int</span> ActSteps=(Steps % 4);
00677         <span class="keywordflow">if</span> (ActSteps&lt;0)
00678                 ActSteps=4+ActSteps;
00679 
00680         <span class="keywordflow">if</span> (pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00681         {
00682                 <a class="code" href="structTString.html">TString</a> str;
00683                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00684                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00685                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_Rotate90() Image is empty - doing nothing"</span>);
00686                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00687                 <span class="keywordflow">return</span>;
00688         }
00689         <span class="keywordflow">if</span> (ActSteps==0)
00690                 <span class="keywordflow">return</span>;
00691 
00692         <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(&amp;NewImage);
00693         <span class="comment">/* prepare destination image, following lines faster than calling kC_CopyImage() */</span>
00694         <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>,pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>,&amp;NewImage);
00695         <a class="code" href="group__filefunctions.html#a2">k_CopyFileInfo</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m0">FileInfo</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00696 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00697 <span class="preprocessor"></span>        <span class="comment">/* copy history before adding comment */</span>
00698         <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00699         <span class="comment">/* add comment to history */</span>
00700         {
00701                 <a class="code" href="structTString.html">TString</a> History;
00702                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00703                 <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Rotate90(Steps=%d)"</span>,ipl_HistoryIndent,Steps);
00704                 <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00705                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00706                 <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00707         }
00708 <span class="preprocessor">#endif</span>
00709 <span class="preprocessor"></span>
00710         <span class="comment">/* rotate image */</span>
00711         <span class="keywordflow">if</span> (ActSteps==1)
00712         {
00713                 <span class="keywordflow">for</span>(y=0; y&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>; y++)
00714                 {
00715                         <span class="keywordflow">for</span>(x=0; x&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>; x++)
00716                         {
00717                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(-y+MaxYIndex,x,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pSource)),NewImage);
00718                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(-y+MaxYIndex,x,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pSource)),NewImage);
00719                         }
00720                 }
00721         }
00722         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ActSteps==2)
00723         {
00724                 <span class="keywordflow">for</span>(y=0; y&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>; y++)
00725                 {
00726                         <span class="keywordflow">for</span>(x=0; x&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>; x++)
00727                         {
00728                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,MaxYIndex-y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pSource)),NewImage);
00729                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,MaxYIndex-y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pSource)),NewImage);
00730                         }
00731                 }
00732         }
00733         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ActSteps==3)
00734         {
00735                 <span class="keywordflow">for</span>(y=0; y&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>; y++)
00736                 {
00737                         <span class="keywordflow">for</span>(x=0; x&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>; x++)
00738                         {
00739                                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(y,MaxXIndex-x,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pSource)),NewImage);
00740                                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(y,MaxXIndex-x,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pSource)),NewImage);
00741                         }
00742                 }               
00743         }
00744         <a class="code" href="group__compleximage.html#a11">kC_CopyImage</a>(pSource,&amp;NewImage);
00745         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(&amp;NewImage);
00746 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00747 <span class="preprocessor"></span>        <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00748         <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00749 <span class="preprocessor">#endif</span>
00750 <span class="preprocessor"></span>}
00751 
<a name="l00752"></a><a class="code" href="group__compleximage.html#a14">00752</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a14">kC_FlipHorisontal</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pSource)
00753 {
00754         <a class="code" href="structTComplexImage.html">TComplexImage</a> Buf;
00755         <span class="keywordtype">int</span> y;
00756         <span class="keywordtype">int</span> Half=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>/2;
00757         <span class="keywordtype">int</span> Ext=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>%2;
00758         <span class="keywordflow">if</span> (pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00759         {
00760                 <a class="code" href="structTString.html">TString</a> str;
00761                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00762                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00763                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_FlipHorisontal() Image is empty - doing nothing"</span>);
00764                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00765                 <span class="keywordflow">return</span>;
00766         }
00767 
00768         <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(&amp;Buf);
00769         <span class="comment">/* flip image */</span>
00770         <span class="comment">/* prepare destination image */</span>
00771         <a class="code" href="group__compleximage.html#a12">kC_CopySubImage</a>(<a class="code" href="group__compleximage.html#a16">kC_GetMinX</a>(pSource),<a class="code" href="group__compleximage.html#a17">kC_GetMinY</a>(pSource),<a class="code" href="group__compleximage.html#a18">kC_GetMaxX</a>(pSource),Half-pSource-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>,&amp;Buf,pSource);
00772 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00773 <span class="preprocessor"></span>        <span class="comment">/* add comment to history */</span>
00774         {
00775                 <a class="code" href="structTString.html">TString</a> History;
00776                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00777                 <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_FlipHorisontal()"</span>,ipl_HistoryIndent);
00778                 <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00779                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00780                 <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00781         }
00782 <span class="preprocessor">#endif</span>
00783 <span class="preprocessor"></span>        <span class="keywordflow">for</span>(y=0;y&lt;Half;y++)
00784         {
00785                 memcpy(pSource-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[y],pSource-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>-y-1],pSource-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>);
00786                 memcpy(pSource-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[y],pSource-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>-y-1],pSource-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>);
00787         }
00788         <span class="keywordflow">for</span>(y=Half+Ext; y&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>; y++)
00789         {
00790                 memcpy(pSource-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[y],Buf.<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>[Buf.<a class="code" href="structTComplexImage.html#m4">Height</a>-(y-Half-Ext)-1],pSource-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>);
00791                 memcpy(pSource-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[y],Buf.<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>[Buf.<a class="code" href="structTComplexImage.html#m4">Height</a>-(y-Half-Ext)-1],pSource-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>);
00792         }
00793         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(&amp;Buf);
00794 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00795 <span class="preprocessor"></span>        <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00796         <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00797 <span class="preprocessor">#endif</span>
00798 <span class="preprocessor"></span>}
00799 
<a name="l00800"></a><a class="code" href="group__compleximage.html#a15">00800</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a15">kC_FlipVertical</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pSource)
00801 {
00802         <a class="code" href="structTComplexImage.html">TComplexImage</a> NewImage;
00803         <span class="keywordtype">int</span> x,y;
00804         <span class="keywordtype">int</span> MaxXIndex=pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>-1;
00805         <span class="keywordflow">if</span> (pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
00806         {
00807                 <a class="code" href="structTString.html">TString</a> str;
00808                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00809                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00810                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_FlipVertical() Image is empty - doing nothing"</span>);
00811                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00812                 <span class="keywordflow">return</span>;
00813         }
00814 
00815         <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(&amp;NewImage);
00816         <span class="comment">/* flip image  */</span>
00817         <span class="comment">/* prepare destination image, following lines faster than calling k_CopyImage() */</span>
00818         <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>,pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>,&amp;NewImage);
00819         <a class="code" href="group__filefunctions.html#a2">k_CopyFileInfo</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m0">FileInfo</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>));
00820 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00821 <span class="preprocessor"></span>        <span class="comment">/* copy history before adding comment */</span>
00822         <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
00823         <span class="comment">/* add comment to history */</span>
00824         {
00825                 <a class="code" href="structTString.html">TString</a> History;
00826                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00827                 <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_FlipVertical()"</span>,ipl_HistoryIndent);
00828                 <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(NewImage.<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00829                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00830                 <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00831         }
00832 <span class="preprocessor">#endif</span>
00833 <span class="preprocessor"></span>        <span class="keywordflow">for</span>(y=0; y&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>; y++)
00834         {
00835                 <span class="keywordflow">for</span>(x=0; x&lt;(int)pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>; x++)
00836                 {
00837                         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(MaxXIndex-x,y,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pSource)),NewImage);
00838                         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(MaxXIndex-x,y,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pSource)),NewImage);
00839                 }
00840         }
00841         <a class="code" href="group__compleximage.html#a11">kC_CopyImage</a>(pSource,&amp;NewImage);
00842         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(&amp;NewImage);
00843 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00844 <span class="preprocessor"></span>        <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00845         <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00846 <span class="preprocessor">#endif</span>
00847 <span class="preprocessor"></span>}
00848 
<a name="l00849"></a><a class="code" href="group__compleximage.html#a16">00849</a> <span class="keywordtype">int</span> <a class="code" href="group__compleximage.html#a16">kC_GetMinX</a>(<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* Img)
00850 {
00851         <span class="keywordflow">return</span> -Img-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
00852 }
00853 
<a name="l00854"></a><a class="code" href="group__compleximage.html#a17">00854</a> <span class="keywordtype">int</span> <a class="code" href="group__compleximage.html#a17">kC_GetMinY</a>(<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* Img)
00855 {
00856         <span class="keywordflow">return</span> -Img-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
00857 }
00858 
<a name="l00859"></a><a class="code" href="group__compleximage.html#a18">00859</a> <span class="keywordtype">int</span> <a class="code" href="group__compleximage.html#a18">kC_GetMaxX</a>(<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* Img)
00860 {
00861         <span class="keywordflow">return</span> Img-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>-Img-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
00862 }
00863 
<a name="l00864"></a><a class="code" href="group__compleximage.html#a19">00864</a> <span class="keywordtype">int</span> <a class="code" href="group__compleximage.html#a19">kC_GetMaxY</a>(<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* Img)
00865 {
00866         <span class="keywordflow">return</span> Img-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>-Img-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
00867 }
00868 
00869 <span class="comment">/****************************************/</span>
00870 <span class="comment">/*        Arithmetic functions          */</span>
00871 <span class="comment">/****************************************/</span>
00872 
<a name="l00873"></a><a class="code" href="group__compleximage.html#a20">00873</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a20">kC_ApplyBias</a>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Bias,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
00874 { 
00875         <span class="keywordflow">if</span> (pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY)
00876         {
00877                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y;
00878 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00879 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
00880                 {
00881                         <a class="code" href="structTString.html">TString</a> History;
00882                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00883                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_ApplyBias() Bias=%g"</span>,ipl_HistoryIndent,Bias);
00884                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00885                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00886                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00887                 }
00888 <span class="preprocessor">#endif</span>
00889 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
00890                 {
00891                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
00892                         {
00893                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]+=Bias;
00894                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]+=Bias;
00895                         }
00896                 }
00897 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00898 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00899                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00900 <span class="preprocessor">#endif</span>
00901 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
00902         }
00903         <span class="keywordflow">else</span>
00904         {
00905                 <a class="code" href="structTString.html">TString</a> str;
00906         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00907                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00908                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_ApplyBias(): Image is empty"</span>);
00909                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00910                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00911         }
00912 }
00913 
<a name="l00914"></a><a class="code" href="group__compleximage.html#a21">00914</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a21">kC_ScaleIntensity</a>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Prefactor,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
00915 { 
00916         <span class="keywordflow">if</span> (pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY)
00917         {
00918                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y;
00919 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00920 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
00921                 {
00922                         <a class="code" href="structTString.html">TString</a> History;
00923                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00924                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_ScaleIntensity() Prefactor=%g"</span>,ipl_HistoryIndent,Prefactor);
00925                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00926                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00927                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00928                 }
00929 <span class="preprocessor">#endif</span>
00930 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
00931                 {
00932                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
00933                         {
00934                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]*=Prefactor;
00935                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]*=Prefactor;
00936                         }
00937                 }
00938 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00939 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00940                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00941 <span class="preprocessor">#endif</span>
00942 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
00943         }
00944         <span class="keywordflow">else</span>
00945         {
00946                 <a class="code" href="structTString.html">TString</a> str;
00947         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00948                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00949                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_ScaleIntensity(): Image is empty"</span>);
00950                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00951                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00952         }
00953 }
00954 
00955 
<a name="l00956"></a><a class="code" href="group__compleximage.html#a22">00956</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a22">kC_Add</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pAddend,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
00957 { 
00958         <span class="keywordflow">if</span> ((pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY) || (pAddend-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY) ||
00959                 (pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>!=pAddend-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>) || (pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>!=pAddend-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>))
00960     {
00961                 <a class="code" href="structTString.html">TString</a> str;
00962                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
00963                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
00964                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Add(): Images are empty or of different size"</span>);
00965                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
00966                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00967     } 
00968         <span class="keywordflow">else</span>
00969     {
00970                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x,y;
00971 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00972 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
00973                 {
00974                         <a class="code" href="structTString.html">TString</a> History;
00975                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
00976                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Add() Adding a TComplexImage"</span>,ipl_HistoryIndent);
00977                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
00978                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
00979                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
00980                 }
00981 <span class="preprocessor">#endif</span>
00982 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
00983                 {
00984                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
00985                         {
00986                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]+=pAddend-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
00987                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]+=pAddend-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
00988                         }
00989                 }
00990 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
00991 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
00992                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
00993 <span class="preprocessor">#endif</span>
00994 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
00995         }
00996 }
00997 
<a name="l00998"></a><a class="code" href="group__compleximage.html#a23">00998</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a23">kC_Subtract</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pSubtrahend,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
00999 { 
01000         <span class="keywordflow">if</span> ((pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY) || (pSubtrahend-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
01001                 || (pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>!=pSubtrahend-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>) || (pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>!=pSubtrahend-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>))
01002     {
01003                 <a class="code" href="structTString.html">TString</a> str;
01004                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01005                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01006                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Subtract(): Images are empty or of different size"</span>);
01007                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01008                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01009     } 
01010         <span class="keywordflow">else</span>
01011     {
01012                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x,y;
01013 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01014 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01015                 {
01016                         <a class="code" href="structTString.html">TString</a> History;
01017                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01018                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Subtract() subtracting a TComplexImage"</span>,ipl_HistoryIndent);
01019                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01020                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01021                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01022                 }
01023 <span class="preprocessor">#endif</span>
01024 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
01025                 {
01026                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
01027                         {
01028                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]-=pSubtrahend-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01029                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]-=pSubtrahend-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01030                         }
01031                 }
01032 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01033 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01034                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01035 <span class="preprocessor">#endif</span>
01036 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01037         }
01038 }
01039 
<a name="l01040"></a><a class="code" href="group__compleximage.html#a24">01040</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a24">kC_Multiply</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg, <a class="code" href="structTComplexImage.html">TComplexImage</a> *pFactor)
01041 { 
01042         <span class="keywordflow">if</span> ((pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY) || (pFactor-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
01043                 || (pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>!=pFactor-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>) || (pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>!=pFactor-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>))
01044     {
01045                 <a class="code" href="structTString.html">TString</a> str;
01046                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01047                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01048                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Multiply(): Images are empty or of different size"</span>);
01049                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01050                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01051     } 
01052         <span class="keywordflow">else</span>
01053     {
01054                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y;
01055                 <span class="keywordtype">float</span> buf1r,buf1i,buf2r,buf2i;
01056 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01057 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01058                 {
01059                         <a class="code" href="structTString.html">TString</a> History;
01060                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01061                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Multiply() multiplying a TComplexImage"</span>,ipl_HistoryIndent);
01062                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01063                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01064                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01065                 }
01066 <span class="preprocessor">#endif</span>
01067 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
01068                 {
01069                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
01070                         {
01071                                 buf1r=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01072                                 buf1i=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01073                                 buf2r=pFactor-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01074                                 buf2i=pFactor-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01075                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=buf1r*buf2r-buf1i*buf2i;
01076                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=buf1r*buf2i+buf1i*buf2r;
01077                         }
01078                 }
01079 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01080 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01081                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01082 <span class="preprocessor">#endif</span>
01083 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01084         }
01085 }
01086 
<a name="l01087"></a><a class="code" href="group__compleximage.html#a25">01087</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a25">kC_CCFactorAndMultiply</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg, <a class="code" href="structTComplexImage.html">TComplexImage</a> *pFactor)
01088 { 
01089         <span class="keywordflow">if</span> ((pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY) || (pFactor-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
01090                 || (pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>!=pFactor-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>) || (pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>!=pFactor-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>))
01091     {
01092                 <a class="code" href="structTString.html">TString</a> str;
01093                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01094                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01095                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CCFactorAndMultiply(): Images are empty or of different size"</span>);
01096                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01097                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01098     }
01099         <span class="keywordflow">else</span>
01100     {
01101                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y;
01102                 <span class="keywordtype">float</span> buf1r,buf1i,buf2r,buf2i;
01103 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01104 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01105                 {
01106                         <a class="code" href="structTString.html">TString</a> History;
01107                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01108                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CCFactorAndMultiply()"</span>,ipl_HistoryIndent);
01109                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01110                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01111                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01112                 }
01113 <span class="preprocessor">#endif</span>
01114 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
01115                 {
01116                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
01117                         {
01118                                 buf1r=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01119                                 buf1i=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01120                                 buf2r=pFactor-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01121                                 buf2i=-pFactor-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01122                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=buf1r*buf2r-buf1i*buf2i;
01123                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=buf1r*buf2i+buf1i*buf2r;
01124                         }
01125                 }
01126 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01127 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01128                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01129 <span class="preprocessor">#endif</span>
01130 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01131         }
01132 }
01133 
<a name="l01134"></a><a class="code" href="group__compleximage.html#a26">01134</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a26">kC_ComplexConjugate</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
01135 { 
01136         <span class="keywordflow">if</span> (pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
01137         {
01138                 <a class="code" href="structTString.html">TString</a> str;
01139                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01140                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01141                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_ComplexConjugate(): Image is empty"</span>);
01142                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01143                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01144         }
01145         <span class="keywordflow">else</span>
01146         {
01147                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, y;
01148 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01149 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01150                 {
01151                         <a class="code" href="structTString.html">TString</a> History;
01152                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01153                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_ComplexConjugate()"</span>,ipl_HistoryIndent);
01154                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01155                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01156                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01157                 }
01158 <span class="preprocessor">#endif</span>
01159 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
01160                 {
01161                         <span class="keywordflow">for</span> (x=0;x&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++) 
01162                         {
01163                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=-pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01164                         }
01165                 }
01166 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01167 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01168                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01169 <span class="preprocessor">#endif</span>
01170 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01171         }
01172 }
01173 
<a name="l01174"></a><a class="code" href="group__compleximage.html#a27">01174</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a27">kC_Rearrange</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
01175 { 
01176         <span class="keywordflow">if</span> (pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
01177         {
01178                 <a class="code" href="structTString.html">TString</a> str;
01179                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01180                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01181                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_Rerrange(): image is empty"</span>);
01182                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01183                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01184         }
01185         <span class="keywordflow">else</span>
01186         {
01187                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x,y,w2,h2;
01188                 <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> re,im;
01189 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01190 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01191                 {
01192                         <a class="code" href="structTString.html">TString</a> History;
01193                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01194                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_Rearrange()"</span>,ipl_HistoryIndent);
01195                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01196                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01197                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01198                 }
01199 <span class="preprocessor">#endif</span>
01200 <span class="preprocessor"></span>                w2=pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>/2;
01201                 h2=pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>/2;
01202                 <span class="keywordflow">for</span> (y=0;y&lt;h2;y++)
01203                 {
01204                         <span class="keywordflow">for</span> (x=0;x&lt;w2;x++)
01205                         { 
01206                                 re=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01207                                 im=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01208                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y+h2][x+w2];
01209                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y+h2][x+w2];
01210                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y+h2][x+w2]=re;
01211                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y+h2][x+w2]=im;
01212                         }
01213                 }
01214                 <span class="keywordflow">for</span> (y=h2;y&lt;pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
01215                 {
01216                         <span class="keywordflow">for</span> (x=0;x&lt;w2;x++)
01217                         {
01218                                 re=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01219                                 im=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01220                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y-h2][x+w2];
01221                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y-h2][x+w2];
01222                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y-h2][x+w2]=re;
01223                                 pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y-h2][x+w2]=im;
01224                         }
01225                 }
01226 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01227 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01228                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01229 <span class="preprocessor">#endif</span>
01230 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01231         }
01232 }
01233 
<a name="l01234"></a><a class="code" href="group__compleximage.html#a28">01234</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a28">kC_CopyDisplace</a>(<span class="keywordtype">int</span> dx,<span class="keywordtype">int</span> dy,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pImg)
01235 {
01236         <span class="keywordflow">if</span> (pImg-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY)
01237         {
01238                 <span class="keywordtype">int</span> x,y,w,h,xd,yd;
01239                 <a class="code" href="structTComplexImage.html">TComplexImage</a> Temp;
01240                 w=pImg-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
01241                 h=pImg-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
01242                 <a class="code" href="group__compleximage.html#a1">kC_InitImage</a>(&amp;Temp);
01243                 <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(w,h,&amp;Temp);
01244                 <span class="comment">/* copy history before adding comment */</span>
01245                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(Temp.<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pImg-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
01246 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01247 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01248                 {
01249                         <a class="code" href="structTString.html">TString</a> History;
01250                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01251                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyDisplace() dx=%d dy=%d"</span>,ipl_HistoryIndent,dx,dy);
01252                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(Temp.<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01253                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01254                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01255                 }
01256 <span class="preprocessor">#endif</span>
01257 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;h;y++)
01258                 {
01259                         <span class="keywordflow">for</span> (x=0;x&lt;w;x++)
01260                         {
01261                                 xd=x-dx;
01262                                 yd=y-dy;
01263                                 <span class="keywordflow">while</span> (xd&lt;0) xd+=w;
01264                                 <span class="keywordflow">while</span> (xd&gt;=w) xd-=w;
01265                                 <span class="keywordflow">while</span> (yd&lt;0) yd+=h;
01266                                 <span class="keywordflow">while</span> (yd&gt;=h) yd-=h;
01267                                 Temp.<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[yd][xd]=pImg-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01268                                 Temp.<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[yd][xd]=pImg-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01269                         }
01270                 }
01271                 <a class="code" href="group__compleximage.html#a11">kC_CopyImage</a>(pImg,&amp;Temp);
01272                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(&amp;Temp);
01273 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01274 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01275                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01276 <span class="preprocessor">#endif</span>
01277 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01278         }
01279         <span class="keywordflow">else</span>
01280         {
01281                 <a class="code" href="structTString.html">TString</a> str;
01282                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01283                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01284                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopyDisplace(): Image is empty"</span>);
01285                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01286                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01287         }
01288 }
01289 
<a name="l01290"></a><a class="code" href="group__compleximage.html#a29">01290</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a29">kC_CutOrZeroPad</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pSource, <a class="code" href="structTComplexImage.html">TComplexImage</a>*pDest)
01291 {
01292         <span class="keywordtype">int</span> x,y,ws,hs,wd,hd;
01293         ws=pSource-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
01294         hs=pSource-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
01295         wd=pDest-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;
01296         hd=pDest-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;
01297         <span class="keywordflow">if</span> ((pSource-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY) &amp;&amp; (pDest-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>!=EMPTY) &amp;&amp;
01298                 (ws&gt;0) &amp;&amp; (hs&gt;0) &amp;&amp; (wd&gt;0) &amp;&amp; (hd&gt;0) &amp;&amp; (pSource!=pDest))
01299         {
01300                 <span class="comment">/* copy history before adding comment */</span>
01301                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pSource-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>));
01302 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01303 <span class="preprocessor"></span>                <span class="comment">/* add comment to history */</span>
01304                 {
01305                         <a class="code" href="structTString.html">TString</a> History;
01306                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01307                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CutOrZeroPad() Source image file info: %s"</span>,
01308                                 ipl_HistoryIndent,pSource-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>.<a class="code" href="structTFileInfo.html#m2">PathAndFileName</a>);
01309                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01310                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01311                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01312                 }
01313 <span class="preprocessor">#endif</span>
01314 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;hd;y++)
01315                 {
01316                         <span class="keywordflow">for</span> (x=0;x&lt;wd;x++)
01317                         { 
01318                                 <span class="keywordflow">if</span> ((x&lt;ws) &amp;&amp; (y&lt;hs))
01319                                 {
01320                                         pDest-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pSource-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x];
01321                                         pDest-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pSource-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x];
01322                                 }
01323                                 <span class="keywordflow">else</span>
01324                                 {
01325                                         pDest-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=0;
01326                                         pDest-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=0;
01327                                 }
01328                         }
01329                 }
01330 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01331 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01332                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01333 <span class="preprocessor">#endif</span>
01334 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01335         } 
01336         <span class="keywordflow">else</span>
01337         {
01338                 <a class="code" href="structTString.html">TString</a> str;
01339                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01340                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01341                 <span class="keywordflow">if</span> (pSource==pDest)
01342                 {
01343                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CutOrZeroPad(): Cannot use same image as dest/source"</span>); 
01344                 }
01345                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ws&lt;=0) || (hs&lt;=0) || (wd&lt;=0) || (hd&lt;=0))
01346                 {
01347                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CutOrZeroPad(): One or both images have no pixels"</span>); 
01348                 }
01349                 <span class="keywordflow">else</span>
01350                 {
01351                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CutOrZeroPad(): One or both images are empty"</span>);
01352                 }
01353                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01354                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01355         }
01356 }
01357 
<a name="l01358"></a><a class="code" href="group__compleximage.html#a30">01358</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a30">kC_CopyFromByte</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pDest, <a class="code" href="structTImage.html">TImage</a> *pRe, <a class="code" href="structTImage.html">TImage</a> *pIm)
01359 {
01360         <span class="keywordtype">int</span> x,y,w,h;
01361         <span class="keywordflow">if</span> ((pRe-&gt;<a class="code" href="structTImage.html#m3">Origin</a>==EMPTY) || (pIm-&gt;<a class="code" href="structTImage.html#m3">Origin</a>==EMPTY) || (pRe-&gt;<a class="code" href="structTImage.html#m4">Width</a>!=pIm-&gt;<a class="code" href="structTImage.html#m4">Width</a>) || (pRe-&gt;<a class="code" href="structTImage.html#m5">Height</a>!=pIm-&gt;<a class="code" href="structTImage.html#m5">Height</a>))
01362         {
01363                 <a class="code" href="structTString.html">TString</a> str;
01364                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01365                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01366                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopyFromByte(): Source images are not same size or empty"</span>);
01367                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01368                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01369                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01370         }
01371         <span class="keywordflow">else</span>
01372         {
01373                 w=pRe-&gt;<a class="code" href="structTImage.html#m4">Width</a>;
01374                 h=pRe-&gt;<a class="code" href="structTImage.html#m5">Height</a>;
01375                 <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(w,h,pDest);
01376 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01377 <span class="preprocessor"></span>                {
01378                         <a class="code" href="structTString.html">TString</a> History;
01379                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01380                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pRe"</span>,ipl_HistoryIndent);
01381                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01382                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01383                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01384                 }
01385                 <span class="comment">/* copy history from pRe before adding comment */</span>
01386                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pRe-&gt;<a class="code" href="structTImage.html#m2">History</a>));
01387                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01388                 {
01389                         <a class="code" href="structTString.html">TString</a> History;
01390                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01391                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pIm"</span>,ipl_HistoryIndent);
01392                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01393                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01394                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01395                 }
01396                 <span class="comment">/* copy history from pRe before adding comment */</span>
01397                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pIm-&gt;<a class="code" href="structTImage.html#m2">History</a>));
01398                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01399                 <span class="comment">/* add comment to history */</span>
01400                 {
01401                         <a class="code" href="structTString.html">TString</a> History;
01402                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01403                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte()"</span>,ipl_HistoryIndent);
01404                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01405                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01406                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01407                 }
01408 <span class="preprocessor">#endif</span>
01409 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;h;y++)
01410                 {
01411                         <span class="keywordflow">for</span> (x=0;x&lt;w;x++)
01412                         {
01413                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pRe-&gt;<a class="code" href="structTImage.html#m11">ppMatrix</a>[y][x];
01414                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pIm-&gt;<a class="code" href="structTImage.html#m11">ppMatrix</a>[y][x];
01415                         }
01416                 }
01417 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01418 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01419                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01420 <span class="preprocessor">#endif</span>
01421 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01422         }
01423 }
01424 
<a name="l01425"></a><a class="code" href="group__compleximage.html#a31">01425</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a31">kC_CopyFromInt</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pDest, <a class="code" href="structTIntImage.html">TIntImage</a> *pRe, <a class="code" href="structTIntImage.html">TIntImage</a> *pIm)
01426 {
01427         <span class="keywordflow">if</span> ((pRe-&gt;<a class="code" href="structTIntImage.html#m2">Origin</a>==EMPTY) || (pIm-&gt;<a class="code" href="structTIntImage.html#m2">Origin</a>==EMPTY) || (pRe-&gt;<a class="code" href="structTIntImage.html#m3">Width</a>!=pIm-&gt;<a class="code" href="structTIntImage.html#m3">Width</a>) || (pRe-&gt;<a class="code" href="structTIntImage.html#m4">Height</a>!=pIm-&gt;<a class="code" href="structTIntImage.html#m4">Height</a>))
01428         {
01429                 <a class="code" href="structTString.html">TString</a> str;
01430                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01431                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01432                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopyFromInt():  Source images are not same size or empty"</span>);
01433                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01434                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01435                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01436         }
01437         <span class="keywordflow">else</span>
01438         {
01439                 <span class="keywordtype">int</span> x,y,w,h;
01440                 w=pRe-&gt;<a class="code" href="structTIntImage.html#m3">Width</a>;
01441                 h=pRe-&gt;<a class="code" href="structTIntImage.html#m4">Height</a>;
01442                 <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(w,h,pDest);
01443 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01444 <span class="preprocessor"></span>                {
01445                         <a class="code" href="structTString.html">TString</a> History;
01446                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01447                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pRe"</span>,ipl_HistoryIndent);
01448                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01449                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01450                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01451                 }
01452                 <span class="comment">/* copy history from pRe before adding comment */</span>
01453                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pRe-&gt;<a class="code" href="structTIntImage.html#m1">History</a>));
01454                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01455                 {
01456                         <a class="code" href="structTString.html">TString</a> History;
01457                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01458                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pIm"</span>,ipl_HistoryIndent);
01459                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01460                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01461                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01462                 }
01463                 <span class="comment">/* copy history from pRe before adding comment */</span>
01464                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pIm-&gt;<a class="code" href="structTIntImage.html#m1">History</a>));
01465                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01466                 <span class="comment">/* add comment to history */</span>
01467                 {
01468                         <a class="code" href="structTString.html">TString</a> History;
01469                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01470                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromInt()"</span>,ipl_HistoryIndent);
01471                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01472                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01473                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01474                 }
01475 <span class="preprocessor">#endif</span>
01476 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;h;y++)
01477                 {
01478                         <span class="keywordflow">for</span> (x=0;x&lt;w;x++)
01479                         {
01480                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pRe-&gt;<a class="code" href="structTIntImage.html#m9">ppMatrix</a>[y][x];
01481                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pIm-&gt;<a class="code" href="structTIntImage.html#m9">ppMatrix</a>[y][x];
01482                         }
01483                 }
01484 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01485 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01486                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01487 <span class="preprocessor">#endif</span>
01488 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01489         }
01490 }
01491 
<a name="l01492"></a><a class="code" href="group__compleximage.html#a32">01492</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a32">kC_CopyFromFloat</a>(<a class="code" href="structTComplexImage.html">TComplexImage</a> *pDest, <a class="code" href="structTFloatImage.html">TFloatImage</a> *pRe, <a class="code" href="structTFloatImage.html">TFloatImage</a> *pIm)
01493 {
01494         <span class="keywordflow">if</span> ((pRe-&gt;<a class="code" href="structTFloatImage.html#m2">Origin</a>==EMPTY) || (pIm-&gt;<a class="code" href="structTFloatImage.html#m2">Origin</a>==EMPTY) || (pRe-&gt;<a class="code" href="structTFloatImage.html#m3">Width</a>!=pIm-&gt;<a class="code" href="structTFloatImage.html#m3">Width</a>) || (pRe-&gt;<a class="code" href="structTFloatImage.html#m4">Height</a>!=pIm-&gt;<a class="code" href="structTFloatImage.html#m4">Height</a>))
01495         {
01496                 <a class="code" href="structTString.html">TString</a> str;
01497                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01498                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01499                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_CopyFromFloat():  Source images are not same size or empty"</span>);
01500                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01501                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01502                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01503         }
01504         <span class="keywordflow">else</span>
01505         {
01506                 <span class="keywordtype">int</span> x,y,w,h;
01507                 w=pRe-&gt;<a class="code" href="structTFloatImage.html#m3">Width</a>;
01508                 h=pRe-&gt;<a class="code" href="structTFloatImage.html#m4">Height</a>;
01509                 <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(w,h,pDest);
01510 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01511 <span class="preprocessor"></span>                {
01512                         <a class="code" href="structTString.html">TString</a> History;
01513                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01514                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pRe"</span>,ipl_HistoryIndent);
01515                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01516                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01517                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01518                 }
01519                 <span class="comment">/* copy history from pRe before adding comment */</span>
01520                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pRe-&gt;<a class="code" href="structTFloatImage.html#m1">History</a>));
01521                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01522                 {
01523                         <a class="code" href="structTString.html">TString</a> History;
01524                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01525                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromByte() History from pIm"</span>,ipl_HistoryIndent);
01526                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01527                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01528                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01529                 }
01530                 <span class="comment">/* copy history from pRe before adding comment */</span>
01531                 <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;(pIm-&gt;<a class="code" href="structTFloatImage.html#m1">History</a>));
01532                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01533                 <span class="comment">/* add comment to history */</span>
01534                 {
01535                         <a class="code" href="structTString.html">TString</a> History;
01536                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;History);
01537                         <a class="code" href="group__string.html#a8">k_SprintfString</a>(&amp;History,<span class="stringliteral">"%skC_CopyFromFloat()"</span>,ipl_HistoryIndent);
01538                         <a class="code" href="group__ipltext.html#a3">k_AppendTextIPL</a>(&amp;(pDest-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),History.<a class="code" href="structTString.html#m2">pChars</a>);
01539                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;History);
01540                         <a class="code" href="group__history.html#a1">k_IplStartHistoryMacro</a>();
01541                 }
01542 <span class="preprocessor">#endif</span>
01543 <span class="preprocessor"></span>                <span class="keywordflow">for</span> (y=0;y&lt;h;y++)
01544                 {
01545                         <span class="keywordflow">for</span> (x=0;x&lt;w;x++)
01546                         {
01547                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a>[y][x]=pRe-&gt;<a class="code" href="structTFloatImage.html#m9">ppMatrix</a>[y][x];
01548                                 pDest-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a>[y][x]=pIm-&gt;<a class="code" href="structTFloatImage.html#m9">ppMatrix</a>[y][x];
01549                         }
01550                 }
01551 <span class="preprocessor">#ifdef IPL_ADD_HISTORY</span>
01552 <span class="preprocessor"></span>                <span class="comment">/* end history appending (remove a leading '\t' character) */</span>
01553                 <a class="code" href="group__history.html#a2">k_IplStopHistoryMacro</a>();
01554 <span class="preprocessor">#endif</span>
01555 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;
01556         }
01557 }
01558 
<a name="l01559"></a><a class="code" href="group__compleximage.html#a33">01559</a> <span class="keywordtype">void</span> <a class="code" href="group__compleximage.html#a33">kC_PrintImageInfo</a>(<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01560 {
01561         <span class="keywordtype">char</span>* Name;
01562         <a class="code" href="group__abstract.html#a0">k_GetOriginString</a>(pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>,&amp;Name);
01563         printf(<span class="stringliteral">"**************** ComplexImage info ********************\n"</span>);
01564         printf(<span class="stringliteral">" Width=%d Height=%d ByteWidth=%d SizeImage=%d\n"</span>,
01565                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m6">ByteWidth</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m5">TotalSize</a>);
01566         printf(<span class="stringliteral">" BorderSize=%d Origo=(%d,%d) Origin=%s\n"</span>,
01567                 pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>,Name);
01568         <a class="code" href="group__filefunctions.html#a3">k_PrintFileInfo</a>(&amp;pInfo-&gt;<a class="code" href="structTComplexImage.html#m0">FileInfo</a>);
01569         free(Name);
01570 }
01571 
<a name="l01572"></a><a class="code" href="group__compleximage.html#a34">01572</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a34">kC_DrawLine</a>(<a class="code" href="structT2DInt.html">T2DInt</a> Start, <a class="code" href="structT2DInt.html">T2DInt</a> End, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Value, <a class="code" href="structTComplexImage.html">TComplexImage</a> *pDest)
01573 {
01574         <a class="code" href="structTPixelGroup.html">TPixelGroup</a> grp;
01575         <span class="keywordflow">if</span> (pDest==NULL)
01576         {
01577                 <a class="code" href="structTString.html">TString</a> str;
01578         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01579                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01580                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_DrawLine(): Image is empty"</span>);
01581                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01582                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01583         }
01584         <a class="code" href="group__pixelgroup.html#a0">k_InitGroup</a>(&amp;grp);
01585         <a class="code" href="group__graphics.html#a0">k_GraphicsGenerateLine</a>(Start,End,&amp;grp);
01586         <a class="code" href="group__pixelgroup.html#a27">k_AddGroupToComplexImage</a>(pDest,&amp;grp,Value);
01587         <span class="keywordflow">return</span> <span class="keyword">true</span>;
01588 }
01589 
<a name="l01590"></a><a class="code" href="group__compleximage.html#a35">01590</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage.html#a35">kC_DrawCircle</a>(<a class="code" href="structT2DInt.html">T2DInt</a> Center, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Radius, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Value, <a class="code" href="structTComplexImage.html">TComplexImage</a> *pDest)
01591 {
01592         <a class="code" href="structTPixelGroup.html">TPixelGroup</a> grp;
01593         <span class="keywordflow">if</span> (pDest==NULL)
01594         {
01595                 <a class="code" href="structTString.html">TString</a> str;
01596         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01597                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01598                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"k_DrawCircle(): Image is empty"</span>);
01599                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01600                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01601         }
01602         <a class="code" href="group__pixelgroup.html#a0">k_InitGroup</a>(&amp;grp);
01603         <a class="code" href="group__graphics.html#a2">k_GraphicsGenerateCircle</a>(Center,Radius,&amp;grp);
01604         <a class="code" href="group__pixelgroup.html#a27">k_AddGroupToComplexImage</a>(pDest,&amp;grp,Value);
01605         <span class="keywordflow">return</span> <span class="keyword">true</span>;
01606 }
01607 
01608 <span class="comment">/************************************************/</span>
01609 <span class="comment">/********        C only functions        ********/</span>
01610 <span class="comment">/************************************************/</span>
01611 
<a name="l01612"></a><a class="code" href="group__compleximage__c__only.html#a0">01612</a> <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> <a class="code" href="group__compleximage__c__only.html#a0">kC_GetPixelRe</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01613 {
01614         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01615         <span class="comment">/* adjust origo offset */</span>
01616         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01617         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01618 
01619         <span class="keywordflow">if</span> ((x&gt;=-border) &amp;&amp; (x&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+border) &amp;&amp;
01620                 (y&gt;=-border) &amp;&amp; (y&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+border))
01621         {
01622                 <span class="keywordflow">return</span> <a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pInfo));
01623         }
01624         <span class="keywordflow">else</span>
01625         {
01626                 <a class="code" href="structTString.html">TString</a> str;
01627                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01628                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01629                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_GetPixel(%d,%d) Outside image and border"</span>,x,y);
01630                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01631                 <span class="keywordflow">return</span> 0;
01632         }
01633 }
01634 
<a name="l01635"></a><a class="code" href="group__compleximage__c__only.html#a1">01635</a> <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> <a class="code" href="group__compleximage__c__only.html#a1">kC_GetPixelIm</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01636 {
01637         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01638         <span class="comment">/* adjust origo offset */</span>
01639         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01640         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01641 
01642         <span class="keywordflow">if</span> ((x&gt;=-border) &amp;&amp; (x&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+border) &amp;&amp;
01643                 (y&gt;=-border) &amp;&amp; (y&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+border))
01644         {
01645                 <span class="keywordflow">return</span> <a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pInfo));
01646         }
01647         <span class="keywordflow">else</span>
01648         {
01649                 <a class="code" href="structTString.html">TString</a> str;
01650                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01651                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01652                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_GetPixel(%d,%d) Outside image and border"</span>,x,y);
01653                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01654                 <span class="keywordflow">return</span> 0;
01655         }
01656 }
01657 
<a name="l01658"></a><a class="code" href="group__compleximage__c__only.html#a2">01658</a> <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> <a class="code" href="group__compleximage__c__only.html#a2">kC_GetPixelFastRe</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01659 {
01660         <span class="comment">/* adjust origo offset */</span>
01661         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01662         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01663 
01664         <span class="keywordflow">return</span> <a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pInfo));
01665 }
01666 
<a name="l01667"></a><a class="code" href="group__compleximage__c__only.html#a3">01667</a> <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> <a class="code" href="group__compleximage__c__only.html#a3">kC_GetPixelFastIm</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y,<span class="keyword">const</span> <a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01668 {
01669         <span class="comment">/* adjust origo offset */</span>
01670         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01671         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01672 
01673         <span class="keywordflow">return</span> <a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pInfo));
01674 }
01675 
<a name="l01676"></a><a class="code" href="group__compleximage__c__only.html#a4">01676</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a4">kC_SetPixel</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01677 {
01678         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01679         <span class="comment">/* adjust origo offset */</span>
01680         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01681         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01682         
01683         <span class="keywordflow">if</span>((x&gt;=-border) &amp;&amp; (x&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+border) &amp;&amp;
01684                 (y&gt;=-border) &amp;&amp; (y&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+border))
01685         {
01686                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,y,Re,(*pInfo));
01687                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,y,Im,(*pInfo));
01688                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
01689         }
01690         <span class="keywordflow">else</span>
01691         {
01692                 <a class="code" href="structTString.html">TString</a> str;
01693                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01694                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01695                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_SetPixel(%d,%d) Outside image and border"</span>,x,y);
01696                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01697                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01698         }
01699 }
01700 
<a name="l01701"></a><a class="code" href="group__compleximage__c__only.html#a5">01701</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a5">kC_SetPixelFast</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01702 {
01703         <span class="comment">/* adjust origo offset */</span>
01704         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01705         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01706         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,y,Re,(*pInfo));
01707         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,y,Im,(*pInfo));
01708         <span class="keywordflow">return</span> <span class="keyword">true</span>;
01709 }
01710 
<a name="l01711"></a><a class="code" href="group__compleximage__c__only.html#a6">01711</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a6">kC_SetPixelRe</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pInfo)
01712 {
01713         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01714         <span class="comment">/* adjust origo offset */</span>
01715         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01716         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01717 
01718         <span class="keywordflow">if</span>((x&gt;=-border) &amp;&amp; (x&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+border) &amp;&amp;
01719                 (y&gt;=-border) &amp;&amp; (y&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+border))
01720         {
01721                 <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,y,Re,(*pInfo));
01722                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
01723         }
01724         <span class="keywordflow">else</span>
01725         {
01726                 <a class="code" href="structTString.html">TString</a> str;
01727                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01728                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01729                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_SetPixelRe(%d,%d) Outside image and border"</span>,x,y);
01730                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01731                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01732         }
01733 }
01734 
<a name="l01735"></a><a class="code" href="group__compleximage__c__only.html#a8">01735</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a8">kC_SetPixelFastRe</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Re,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pInfo)
01736 {
01737         <span class="comment">/* adjust origo offset */</span>
01738         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01739         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01740 
01741         <a class="code" href="group__compleximage__c__only.html#a12">kC_SetPixelMacroRe</a>(x,y,Re,(*pInfo));
01742         <span class="keywordflow">return</span> <span class="keyword">true</span>;
01743 }
01744 
<a name="l01745"></a><a class="code" href="group__compleximage__c__only.html#a7">01745</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a7">kC_SetPixelIm</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pInfo)
01746 {
01747         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01748         <span class="comment">/* adjust origo offset */</span>
01749         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01750         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01751 
01752         <span class="keywordflow">if</span>((x&gt;=-border) &amp;&amp; (x&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+border) &amp;&amp;
01753                 (y&gt;=-border) &amp;&amp; (y&lt;(int) pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+border))
01754         {
01755                 <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,y,Im,(*pInfo));
01756                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
01757         }
01758         <span class="keywordflow">else</span>
01759         {
01760                 <a class="code" href="structTString.html">TString</a> str;
01761                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01762                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01763                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_SetPixelIm(%d,%d) Outside image and border"</span>,x,y);
01764                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01765                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01766         }
01767 }
01768 
<a name="l01769"></a><a class="code" href="group__compleximage__c__only.html#a9">01769</a> <span class="keywordtype">bool</span> <a class="code" href="group__compleximage__c__only.html#a9">kC_SetPixelFastIm</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Im,<a class="code" href="structTComplexImage.html">TComplexImage</a> *pInfo)
01770 {
01771         <span class="comment">/* adjust origo offset */</span>
01772         x += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m0">x</a>;
01773         y += pInfo-&gt;<a class="code" href="structTComplexImage.html#m8">Origo</a>.<a class="code" href="structT2DInt.html#m1">y</a>;
01774 
01775         <a class="code" href="group__compleximage__c__only.html#a13">kC_SetPixelMacroIm</a>(x,y,Im,(*pInfo));
01776         <span class="keywordflow">return</span> <span class="keyword">true</span>;
01777 }
01778 
01779 <span class="comment">/************************************************/</span>
01780 <span class="comment">/********        Private functions       ********/</span>
01781 <span class="comment">/************************************************/</span>
01782 
01783 <span class="keywordtype">void</span> kC_SetImageMatrix(<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01784 {
01785         <span class="comment">/* Sets "pInfo-&gt;ppMatrix[y]" to point to start of every scan line</span>
01786 <span class="comment">           inside image and set the pInfo-&gt;ppMatrix[y][x]</span>
01787 <span class="comment">           call this function after pInfo-&gt;BorderSize is set */</span>
01788         <a class="code" href="group__valuetypes.html#a5">UINT32</a> y;
01789         <a class="code" href="group__valuetypes.html#a3">UINT16</a> border=pInfo-&gt;<a class="code" href="structTComplexImage.html#m7">BorderSize</a>;
01790         <a class="code" href="group__valuetypes.html#a5">UINT32</a> totalHeight=pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>+2*border;
01791         <a class="code" href="group__valuetypes.html#a5">UINT32</a> realX=pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>+2*border; <span class="comment">/* width of image + border */</span>
01792         <a class="code" href="group__valuetypes.html#a5">UINT32</a> UINT32Value; <span class="comment">/* temporary variable */</span>
01793         <span class="comment">/* calculate size and width (incl zero-padding) of image + border */</span>
01794         UINT32Value=kC_GetSizeScanLine(realX)/<span class="keyword">sizeof</span>(FLOAT32);
01795         <span class="comment">/*printf("totalHeight=%d\n",totalHeight);*/</span>
01796         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>!=NULL)
01797         {
01798                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>);
01799         }
01800         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>!=NULL)
01801         {
01802                 free(pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>);
01803         }
01804         
01805         (pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>) = (<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>**) malloc(<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*)*(totalHeight));
01806         pInfo-&gt;<a class="code" href="structTComplexImage.html#m9">ppMatrixRe</a> = &amp;((pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>)[border]);
01807         (pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>) = (<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>**) malloc(<span class="keyword">sizeof</span>(<a class="code" href="group__valuetypes.html#a6">FLOAT32</a>*)*(totalHeight));
01808         pInfo-&gt;<a class="code" href="structTComplexImage.html#m10">ppMatrixIm</a> = &amp;((pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>)[border]);
01809         
01810         <span class="keywordflow">for</span>(y=0;y&lt;totalHeight;y++)
01811         {
01812                 (pInfo-&gt;<a class="code" href="structTComplexImage.html#m13">ppAllScanLinesRe</a>)[totalHeight-1-y]=(pInfo-&gt;<a class="code" href="structTComplexImage.html#m11">pPixelStreamRe</a>+y*UINT32Value+border);
01813                 (pInfo-&gt;<a class="code" href="structTComplexImage.html#m14">ppAllScanLinesIm</a>)[totalHeight-1-y]=(pInfo-&gt;<a class="code" href="structTComplexImage.html#m12">pPixelStreamIm</a>+y*UINT32Value+border);
01814         }
01815 }
01816 
01817 <a class="code" href="group__valuetypes.html#a5">UINT32</a> kC_GetSizeScanLine(<a class="code" href="group__valuetypes.html#a5">UINT32</a> Width)
01818 {
01819         <span class="comment">/* returns the size of a scanline, no zero padding in a float image */</span>
01820         <span class="keywordflow">return</span> Width*<span class="keyword">sizeof</span>(FLOAT32);
01821 }
01822 
01823 <span class="keywordtype">bool</span> kC_LoadComplex(FILE* fp,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
01824 {
01825         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Width,Height;
01826         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Rows,Cols;
01827         <a class="code" href="group__valuetypes.html#a5">UINT32</a> x,y;
01828         <a class="code" href="group__valuetypes.html#a6">FLOAT32</a> Value;
01829         <span class="keywordtype">bool</span> WidthHeightRead=<span class="keyword">false</span>;
01830         <span class="comment">/* when set to true, the first token has been read and following comment lines</span>
01831 <span class="comment">           (starting with '#') will not be added to the history */</span>
01832         <span class="keywordtype">bool</span> TokenRead=<span class="keyword">false</span>;
01833         <a class="code" href="structTIplText.html">TIplText</a> TempHistory; <span class="comment">/* keep history in a tempory variable and copy in the end to pInfo */</span>
01834         <a class="code" href="group__ipltext.html#a0">k_InitText</a>(&amp;TempHistory);
01835         <a class="code" href="group__filefunctions.html#a10">k_SkipWhiteSpace</a>(fp);
01836         <span class="keywordflow">while</span> (fgetc(fp)==<span class="charliteral">'#'</span>)
01837         {
01838                 <span class="keywordflow">if</span> ((fgetc(fp)!=<span class="charliteral">'#'</span>) &amp;&amp; (TokenRead==<span class="keyword">false</span>))
01839                 {
01840                         <span class="comment">/* no tokens read yet, add comment line to history */</span>
01841                         <span class="keywordtype">int</span> CharsInLine=<a class="code" href="group__filefunctions.html#a11">k_SkipLine</a>(fp);
01842                         <span class="keywordflow">if</span> (CharsInLine==-1)
01843                         {
01844                                 <a class="code" href="structTString.html">TString</a> str;
01845                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01846                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01847                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadFloat() wrong header - "</span>
01848                                         <span class="stringliteral">"only found a history - no data"</span>);
01849                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01850                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01851                         }
01852                         <span class="keywordflow">else</span>
01853                         {
01854                                 <span class="keywordtype">char</span>* pStr=(<span class="keywordtype">char</span>*)malloc((CharsInLine+2)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
01855                                 fseek(fp,-(CharsInLine+2),SEEK_CUR); <span class="comment">/* rewind file pointer to beginning of the current line */</span>
01856                                 fread(pStr,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>),CharsInLine+1,fp);
01857                                 pStr[CharsInLine+1]=<span class="charliteral">'\0'</span>;
01858                                 <a class="code" href="group__ipltext.html#a2">k_AppendText</a>(&amp;TempHistory,pStr);
01859                                 free(pStr);
01860                         }
01861                 }
01862                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((fgetc(fp)!=<span class="charliteral">'#'</span>) &amp;&amp; (TokenRead==<span class="keyword">true</span>))
01863                 {
01864                         <span class="comment">/* at least one token already read, then just skip the rest ot the commentlines */</span>
01865                         <a class="code" href="group__filefunctions.html#a11">k_SkipLine</a>(fp);
01866                 }
01867                 <span class="keywordflow">else</span>
01868                 {
01869                         <span class="comment">/* read a special comment line */</span>
01870                         <span class="keywordtype">char</span>* Token=NULL;
01871                         <a class="code" href="group__filefunctions.html#a12">k_ReadToken</a>(fp,&amp;Token);
01872                         <span class="keywordflow">if</span> (Token==NULL)
01873                         {
01874                                 <a class="code" href="structTString.html">TString</a> str;
01875                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01876                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01877                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() wrong file format, end of file reached"</span>);
01878                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01879                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01880                         }
01881                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(Token,<span class="stringliteral">"WidthHeight"</span>)==0)
01882                         {
01883                                 <span class="comment">/* The following two values must be integers */</span>
01884                                 <span class="keywordflow">if</span> (fscanf(fp,<span class="stringliteral">"%d %d"</span>,&amp;Width,&amp;Height)!=2)
01885                                 {
01886                                         <a class="code" href="structTString.html">TString</a> str;
01887                                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01888                                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01889                                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() wrong header - "</span>
01890                                                 <span class="stringliteral">"found \"## WidthHeight\" but no width and height values found"</span>);
01891                                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01892                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
01893                                 }
01894                                 <span class="keywordflow">if</span> (WidthHeightRead==<span class="keyword">true</span>)
01895                                 {
01896                                         <span class="comment">/* test if rows and cols is the same as width and height */</span>
01897                                         <span class="keywordflow">if</span> ((Width!=Cols) || (Height!=Rows))
01898                                         {
01899                                                 <a class="code" href="structTString.html">TString</a> str;
01900                                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01901                                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01902                                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Width=Cols (%d=%d) and height=Rows (%d,%d) "</span>
01903                                                         <span class="stringliteral">"does not match"</span>,Width,Cols,Height,Cols,Rows);
01904                                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01905                                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01906                                         }
01907                                 }
01908                                 <span class="keywordflow">else</span>
01909                                         WidthHeightRead=<span class="keyword">true</span>;
01910                         }
01911                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(Token,<span class="stringliteral">"RowsCols"</span>)==0)
01912                         {
01913                                 <span class="keywordflow">if</span> (fscanf(fp,<span class="stringliteral">"%d %d"</span>,&amp;Rows,&amp;Cols)!=2)
01914                                 {
01915                                         <a class="code" href="structTString.html">TString</a> str;
01916                                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01917                                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01918                                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() wrong header - "</span>
01919                                                 <span class="stringliteral">"found \"## WidthHeight\" but no width and height values found"</span>);
01920                                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01921                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
01922                                 }
01923                                 <span class="keywordflow">if</span> (WidthHeightRead==<span class="keyword">true</span>)
01924                                 {
01925                                         <span class="comment">/* test if rows and cols is the same as width and height */</span>
01926                                         <span class="keywordflow">if</span> ((Width!=Cols) || (Height!=Rows))
01927                                         {
01928                                                 <a class="code" href="structTString.html">TString</a> str;
01929                                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01930                                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01931                                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Width=Cols (%d=%d) and height=Rows (%d,%d) "</span>
01932                                                         <span class="stringliteral">"does not match"</span>,Width,Cols,Height,Cols,Rows);
01933                                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01934                                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01935                                         }
01936                                 }
01937                                 <span class="keywordflow">else</span>
01938                                 {
01939                                         <span class="comment">/* no width and height found - use rows and cols to define size */</span>
01940                                         Width=Cols;
01941                                         Height=Rows;
01942                                         WidthHeightRead=<span class="keyword">true</span>;
01943                                 }
01944                         }
01945                         <span class="keywordflow">if</span> (Token!=NULL)
01946                                 free(Token);
01947                 }
01948                 <a class="code" href="group__filefunctions.html#a10">k_SkipWhiteSpace</a>(fp);
01949         }
01950         fseek(fp,-1,SEEK_CUR); <span class="comment">/* reverse fp by 1 */</span>
01951         <span class="comment">/* Now we must be at the beginning of the image data */</span>
01952         <span class="keywordflow">if</span> (WidthHeightRead==<span class="keyword">false</span>)
01953         {
01954                 <a class="code" href="structTString.html">TString</a> str;
01955                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01956                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01957                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() wrong header - width and height not found"</span>);
01958                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01959                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01960         }
01961         <span class="comment">/* allocate image */</span>
01962         <a class="code" href="group__compleximage.html#a2">kC_AllocImage</a>(Width,Height,pInfo);
01963         <span class="comment">/* Read data */</span>
01964         <span class="comment">/* read the real values */</span>
01965         <span class="keywordflow">for</span>(y=0;y&lt;Height;y++)
01966         {
01967                 <span class="keywordflow">for</span>(x=0;x&lt;Width;x++)
01968                 {
01969                         <span class="keywordflow">if</span> (<a class="code" href="group__filefunctions.html#a10">k_SkipWhiteSpace</a>(fp)!=-1)
01970                         {
01971                                 <span class="keywordflow">if</span> (fscanf(fp,<span class="stringliteral">"%e"</span>,&amp;Value)==1)
01972                                 {
01973                                         <a class="code" href="group__compleximage__c__only.html#a6">kC_SetPixelRe</a>(x,y,Value,pInfo);
01974                                 }
01975                                 <span class="keywordflow">else</span>
01976                                 {
01977                                         <a class="code" href="structTString.html">TString</a> str;
01978                                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01979                                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01980                                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Failed reading real values"</span>);
01981                                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01982                                         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
01983                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
01984                                 }
01985                         }
01986                         <span class="keywordflow">else</span>
01987                         {
01988                                 <a class="code" href="structTString.html">TString</a> str;
01989                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
01990                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
01991                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Failed reading real values"</span>);
01992                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
01993                                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
01994                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
01995                         }
01996                 }
01997         }
01998 
01999         <span class="comment">/* read the imaginar values */</span>
02000         <span class="keywordflow">for</span>(y=0;y&lt;Height;y++)
02001         {
02002                 <span class="keywordflow">for</span>(x=0;x&lt;Width;x++)
02003                 {
02004                         <span class="keywordflow">if</span> (<a class="code" href="group__filefunctions.html#a10">k_SkipWhiteSpace</a>(fp)!=-1)
02005                         {
02006                                 <span class="keywordflow">if</span> (fscanf(fp,<span class="stringliteral">"%e"</span>,&amp;Value)==1)
02007                                 {
02008                                         <a class="code" href="group__compleximage__c__only.html#a7">kC_SetPixelIm</a>(x,y,Value,pInfo);
02009                                 }
02010                                 <span class="keywordflow">else</span>
02011                                 {
02012                                         <a class="code" href="structTString.html">TString</a> str;
02013                                         <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
02014                                         <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
02015                                         <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Failed reading imaginar values"</span>);
02016                                         <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
02017                                         <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
02018                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
02019                                 }
02020                         }
02021                         <span class="keywordflow">else</span>
02022                         {
02023                                 <a class="code" href="structTString.html">TString</a> str;
02024                                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
02025                                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
02026                                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_ERROR,&amp;str,<span class="stringliteral">"kC_LoadComplex() Failed reading imaginar values"</span>);
02027                                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
02028                                 <a class="code" href="group__compleximage.html#a0">kC_EmptyImage</a>(pInfo);
02029                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
02030                         }
02031                 }
02032         }
02033         <span class="comment">/* copy history to pInfo */</span>
02034         <a class="code" href="group__ipltext.html#a5">k_CopyText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;TempHistory);
02035         <a class="code" href="group__ipltext.html#a1">k_EmptyText</a>(&amp;TempHistory);
02036         <span class="keywordflow">return</span> <span class="keyword">true</span>;
02037 }
02038 
02039 <span class="keywordtype">bool</span> kC_SaveComplex(FILE* fp,<a class="code" href="structTComplexImage.html">TComplexImage</a>* pInfo)
02040 {
02041         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x,y;
02042         <span class="keywordtype">char</span>* pHistory=NULL;
02043         <span class="keywordflow">if</span> (pInfo-&gt;<a class="code" href="structTComplexImage.html#m2">Origin</a>==EMPTY)
02044         {
02045                 <a class="code" href="structTString.html">TString</a> str;
02046                 <a class="code" href="group__string.html#a0">k_InitString</a>(&amp;str);
02047                 <a class="code" href="group__string.html#a15">k_AddFileAndLine</a>(str);
02048                 <a class="code" href="group__errorhandling.html#a0">k_ShowMessage</a>(IPL_WARNING,&amp;str,<span class="stringliteral">"kC_SaveComplex() No image to save"</span>);
02049                 <a class="code" href="group__string.html#a1">k_EmptyString</a>(&amp;str);
02050                 fclose(fp);
02051                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
02052         }
02053         <a class="code" href="group__ipltext.html#a14">k_ListToCharArrayText</a>(&amp;(pInfo-&gt;<a class="code" href="structTComplexImage.html#m1">History</a>),&amp;pHistory);
02054         fprintf(fp,<span class="stringliteral">"%s\n"</span>,pHistory);
02055         <span class="keywordflow">if</span> (pHistory!=NULL)
02056         {
02057                 free(pHistory);
02058         }
02059         fprintf(fp,<span class="stringliteral">"## WidthHeight %d %d\n"</span>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>);
02060         fprintf(fp,<span class="stringliteral">"## RowsCols %d %d\n\n"</span>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>,pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>);
02061         <span class="keywordflow">for</span>(y=0;y&lt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
02062         {
02063                 <span class="keywordflow">for</span>(x=0;x&lt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
02064                 {
02065                         fprintf(fp,<span class="stringliteral">"% e\t"</span>,<a class="code" href="group__compleximage__c__only.html#a10">kC_GetPixelMacroRe</a>(x,y,(*pInfo)));
02066                 }
02067                 fprintf(fp,<span class="stringliteral">"\n"</span>);
02068         }
02069         <span class="keywordflow">for</span>(y=0;y&lt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m4">Height</a>;y++)
02070         {
02071                 <span class="keywordflow">for</span>(x=0;x&lt;pInfo-&gt;<a class="code" href="structTComplexImage.html#m3">Width</a>;x++)
02072                 {
02073                         fprintf(fp,<span class="stringliteral">"% e\t"</span>,<a class="code" href="group__compleximage__c__only.html#a11">kC_GetPixelMacroIm</a>(x,y,(*pInfo)));
02074                 }
02075                 fprintf(fp,<span class="stringliteral">"\n"</span>);
02076         }
02077         <span class="keywordflow">return</span> <span class="keyword">true</span>;
02078 }
02079 
02080 <span class="preprocessor">#ifdef _IPL98_USING_CPP</span>
02081 <span class="preprocessor"></span>} <span class="comment">/* end of extern "C" */</span>
02082 } <span class="comment">/* end namespace ipl */</span>
02083 <span class="preprocessor">#endif</span>
</pre></div><!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<title>Tag</title>
<base target="_top">
</head>

<body bgcolor="#FFFFFF">

<hr>

<p align="right"><font size="2"><em>Updated <!--webbot bot="Timestamp" s-type="EDITED" s-format="%d. %B %Y %H:%M" startspan -->21. juli 2002 12:29<!--webbot bot="Timestamp" endspan i-checksum="38834" --> by
<a href="http://www.mip.sdu.dk/~edr/">René Dencker
Eriksen</a>(<a href="mailto:edr@mip.sdu.dk">edr@mip.sdu.dk</a>)</em></font></p>
</body>
</html>
