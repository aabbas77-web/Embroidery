<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link type="text/css" href="../../doxygen.css" rel="stylesheet">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Image Processing Library 98</title>
</head>

<body>
<h2 align="center"><a href="http://www.mip.sdu.dk/ipl98" target="_blank"><img border="0" src="ipl_doc_header.gif" width="694" height="55"></a></h2>

</body>

</html>
<!-- Generated by Doxygen 1.2.17 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/ipl98/cpp/algorithms/hough_transform/binary_image.cpp</h1><div class="fragment"><pre>00001 <span class="comment">/********************************************************************</span>
00002 <span class="comment">   The Image Processing Library 98 - IPL98</span>
00003 <span class="comment">   Copyright (C) by René Dencker Eriksen - edr@mip.sdu.dk</span>
00004 <span class="comment"></span>
00005 <span class="comment">   This library is free software; you can redistribute it and/or</span>
00006 <span class="comment">   modify it under the terms of the GNU Lesser General Public</span>
00007 <span class="comment">   License as published by the Free Software Foundation. Only</span>
00008 <span class="comment">   addition is, that if the library is used in proprietary software</span>
00009 <span class="comment">   it must be stated that IPL98 was used.</span>
00010 <span class="comment"></span>
00011 <span class="comment">   This library is distributed in the hope that it will be useful,</span>
00012 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00013 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
00014 <span class="comment"></span>
00015 <span class="comment">   More details can be found in the file licence.txt distributed</span>
00016 <span class="comment">   with this library.</span>
00017 <span class="comment">*********************************************************************/</span>
00018 
00019 <span class="preprocessor">#include "binary_image.h"</span>
00020 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00021 <span class="preprocessor">#include "../../ipl98_general_functions.h"</span>
00022 
00023 <span class="keyword">namespace </span>ipl {
00024 
00025 <span class="keyword">using</span> std::find;
00026 
00028 <span class="comment">// Construction/Destruction</span>
00030 <span class="comment"></span>
<a name="l00031"></a><a class="code" href="classipl_1_1CBinaryImage.html#a0">00031</a> CBinaryImage::CBinaryImage() { ; }
00032 
00033 
<a name="l00034"></a><a class="code" href="classipl_1_1CBinaryImage.html#a1">00034</a> CBinaryImage::CBinaryImage(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h, CHoughBase::ORIGINTYPE OriginType) {
00035    m_width = w;
00036    m_height = h;
00037    this-&gt;SetOrigin(OriginType);
00038 }
00039 
00040 
<a name="l00041"></a><a class="code" href="classipl_1_1CBinaryImage.html#a2">00041</a> CBinaryImage::CBinaryImage(<span class="keyword">const</span> <a class="code" href="classipl_1_1CStdImage.html">CStdImage</a>&amp; Source, COLORTYPE Color, UINT8 Threshold, 
00042                            CHoughBase::ORIGINTYPE OriginType) {
00043    <span class="keywordtype">int</span> x, y, p;
00044 
00045    m_width = Source.<a class="code" href="classipl_1_1CStdImage.html#a50">GetWidth</a>();
00046    m_height = Source.<a class="code" href="classipl_1_1CStdImage.html#a51">GetHeight</a>();
00047 
00048    this-&gt;SetOrigin(OriginType);
00049    <span class="keywordtype">bool</span> color = <span class="keyword">false</span>;
00050    <span class="keywordflow">if</span> (Color == HIGHCOLOR) color = <span class="keyword">true</span>;
00051 
00052    <span class="keywordflow">for</span> (y=0; y&lt;m_height; y++) {
00053       <span class="keywordflow">for</span> (x=0; x&lt;m_width; x++) {
00054          p = Source.<a class="code" href="classipl_1_1CStdImage.html#a21">GetPixelFast</a>(x,y);
00055          <span class="keywordflow">if</span> ((color)^(p&gt;Threshold)) {
00056             <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a> pixel(x,y);
00057             pixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a13">GetX</a>()*(pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>()-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()));
00058             pixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a14">GetY</a>()*(pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>()-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()));
00059             m_coord.push_back(pixel);
00060          }
00061       }
00062    }
00063 }
00064 
00065 
<a name="l00066"></a><a class="code" href="classipl_1_1CBinaryImage.html#a3">00066</a> CBinaryImage::~CBinaryImage() { ; }
00067 
00068 
00070 <span class="comment">// Public methods</span>
00072 <span class="comment"></span>
<a name="l00073"></a><a class="code" href="classipl_1_1CBinaryImage.html#a6">00073</a> <span class="keywordtype">int</span> CBinaryImage::GetHeight()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_height; }
00074 
00075 
<a name="l00076"></a><a class="code" href="classipl_1_1CBinaryImage.html#a5">00076</a> <span class="keywordtype">int</span> CBinaryImage::GetWidth()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_width; }
00077 
00078 
<a name="l00079"></a><a class="code" href="classipl_1_1CBinaryImage.html#a7">00079</a> <span class="keywordtype">int</span> CBinaryImage::GetSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_coord.size(); }
00080 
00081 
<a name="l00082"></a><a class="code" href="classipl_1_1CBinaryImage.html#a8">00082</a> <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a> CBinaryImage::GetPixel(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_coord[i]; }
00083 
00084 
<a name="l00085"></a><a class="code" href="classipl_1_1CBinaryImage.html#a4">00085</a> <span class="keywordtype">void</span> CBinaryImage::ToImage(<a class="code" href="classipl_1_1CStdImage.html">CStdImage</a>&amp; image) {
00086    <span class="keywordtype">int</span> n = m_coord.size();
00087    image.<a class="code" href="classipl_1_1CStdImage.html#a3">AllocFast</a>(m_width, m_height, 8);
00088    image.<a class="code" href="classipl_1_1CStdImage.html#a16">Flush</a>(255);
00089    <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a> pixel;
00090 
00091    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {
00092       pixel = m_coord[i];
00093       pixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a13">GetX</a>()*pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>()+m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00094       pixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a14">GetY</a>()*pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>()+m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00095       <span class="keywordflow">if</span> (0&lt;=pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;m_width &amp;&amp; 0&lt;=pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>() &amp;&amp; pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;m_height) {
00096          image.<a class="code" href="classipl_1_1CStdImage.html#a35">SetPixelFast</a>(pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>(), pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>(), 0);
00097       }
00098    }
00099 }
00100 
00101 
<a name="l00102"></a><a class="code" href="classipl_1_1CBinaryImage.html#a22">00102</a> <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a> CBinaryImage::OriginConvert(<span class="keyword">const</span> <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a>&amp; pixel) {
00103    <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a> outPixel;
00104    outPixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a13">GetX</a>()*pixel.<a class="code" href="classCPoint2D.html#a13">GetX</a>()+m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00105    outPixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>(m_originOrientation.<a class="code" href="classCPoint2D.html#a14">GetY</a>()*pixel.<a class="code" href="classCPoint2D.html#a14">GetY</a>()+m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00106    <span class="keywordflow">return</span> outPixel;
00107 }
00108 
00109 
<a name="l00110"></a><a class="code" href="classipl_1_1CBinaryImage.html#a17">00110</a> <span class="keywordtype">void</span> CBinaryImage::AddPixel(<span class="keyword">const</span> <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a>&amp; pixel) {
00111         std::vector&lt;CPoint2D&lt;int&gt; &gt;::iterator p;
00112    p = find(m_coord.begin(), m_coord.end(), pixel);
00113    <span class="keywordflow">if</span> (p == m_coord.end()) {
00114       m_coord.push_back(pixel);
00115    }
00116 }
00117 
00118 
<a name="l00119"></a><a class="code" href="classipl_1_1CBinaryImage.html#a18">00119</a> <span class="keywordtype">void</span> CBinaryImage::AddPixelFast(<span class="keyword">const</span> <a class="code" href="classCPoint2D.html">CPoint2D&lt;int&gt;</a>&amp; pixel) { m_coord.push_back(pixel); }
00120 
00121 
<a name="l00122"></a><a class="code" href="classipl_1_1CBinaryImage.html#a9">00122</a> <span class="keywordtype">void</span> CBinaryImage::RemovePixel(<span class="keywordtype">int</span> i) {
00123    m_coord[i] = m_coord[m_coord.size()-1];
00124    m_coord.resize(m_coord.size()-1);
00125 }
00126 
00127 
<a name="l00128"></a><a class="code" href="classipl_1_1CBinaryImage.html#a10">00128</a> <span class="keywordtype">bool</span> CBinaryImage::RemovePixel(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a>&amp; p) {
00129    <span class="keywordflow">if</span> (m_coord.size() &lt;= 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00130    std::vector&lt;CPoint2D&lt;int&gt; &gt;::iterator pos = m_coord.begin();
00131    
00132    <span class="keywordflow">while</span> (pos != m_coord.end()) {
00133       pos = find(pos, m_coord.end(), p);
00134       <span class="keywordflow">if</span> (pos == m_coord.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00135       <span class="keywordflow">else</span> {
00136          *pos = m_coord[m_coord.size()-1];
00137          m_coord.resize(m_coord.size()-1);
00138       }
00139    }
00140    <span class="keywordflow">return</span> <span class="keyword">true</span>;
00141 }
00142 
00143 
<a name="l00144"></a><a class="code" href="classipl_1_1CBinaryImage.html#a11">00144</a> <span class="keywordtype">bool</span> CBinaryImage::RemovePixelFast(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a>&amp; p) {
00145    <span class="keywordflow">if</span> (m_coord.size() &lt;= 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00146    std::vector&lt;CPoint2D&lt;int&gt; &gt;::iterator pos = find(m_coord.begin(), m_coord.end(), p);
00147    <span class="keywordflow">if</span> (pos == m_coord.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00148    <span class="keywordflow">else</span> {
00149       *pos = m_coord[m_coord.size()-1];
00150       m_coord.resize(m_coord.size()-1);
00151       <span class="keywordflow">return</span> <span class="keyword">true</span>;
00152    }
00153 }
00154 
00155 
<a name="l00156"></a><a class="code" href="classipl_1_1CBinaryImage.html#a12">00156</a> <span class="keywordtype">bool</span> CBinaryImage::RemovePixelRange(<a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a>&amp; p, <span class="keywordtype">int</span> range) {
00157 <span class="comment">//   CPoint2D&lt;int&gt; newpixel = p;</span>
00158    <span class="keywordtype">int</span> x, y;
00159    <span class="keywordtype">int</span> x_s = p.<a class="code" href="classCPoint2D.html#a13">GetX</a>(), y_s = p.<a class="code" href="classCPoint2D.html#a14">GetY</a>();
00160    <span class="comment">// Horisontal</span>
00161    <span class="keywordflow">for</span> (x=x_s-range; x&lt;=x_s+range; x++) {
00162       p.<a class="code" href="classCPoint2D.html#a16">SetX</a>(x);
00163       this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a11">RemovePixelFast</a>(p);
00164    }
00165    <span class="comment">// Vertical</span>
00166    p.<a class="code" href="classCPoint2D.html#a16">SetX</a>(x_s);
00167    <span class="keywordflow">for</span> (y=y_s-range; y&lt;=y_s+range; y++) {
00168       p.<a class="code" href="classCPoint2D.html#a17">SetY</a>(y);
00169       this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a11">RemovePixelFast</a>(p);
00170    }
00171    p.<a class="code" href="classCPoint2D.html#a15">Set</a>(x_s,y_s);
00172 
00173    <span class="keywordflow">return</span> <span class="keyword">true</span>;
00174 }
00175 
00176 
<a name="l00177"></a><a class="code" href="classipl_1_1CBinaryImage.html#a13">00177</a> <span class="keywordtype">void</span> CBinaryImage::RemoveLine1(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a>&amp; p, <span class="keywordtype">int</span> Thickness)
00178 {
00179         <span class="keywordtype">float</span> C = (float) cos(p.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00180         <span class="keywordtype">float</span> S = (float) sin(p.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00181         <span class="keywordtype">float</span> rho = p.<a class="code" href="classCPoint2D.html#a14">GetY</a>();
00182         <span class="keywordtype">int</span> x, y;
00183         
00184         <a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a> pixel;
00185         
00186         <span class="keywordflow">if</span> (p.<a class="code" href="classCPoint2D.html#a13">GetX</a>() == 0.0f)
00187         {
00188                 <span class="keywordflow">for</span> (y=-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>(); y&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>(); y++)
00189                 {
00190                         x = <a class="code" href="group__templates.html#a6">Round</a>((rho - y*S) / C);
00191                         <span class="keywordflow">if</span> (-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;=x &amp;&amp; x&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()) 
00192                         {
00193                                 pixel.<a class="code" href="classCPoint2D.html#a15">Set</a>(x,y);
00194                                 this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a12">RemovePixelRange</a>(pixel, Thickness);
00195                         }
00196                 }
00197         }
00198         <span class="keywordflow">else</span>
00199         {
00200                 <span class="keywordflow">for</span> (x=-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>(); x&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>(); x++)
00201                 {
00202                         y = <a class="code" href="group__templates.html#a6">Round</a>((rho - x*C) / S);
00203                         <span class="keywordflow">if</span> (-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;=y &amp;&amp; y&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>())
00204                         {
00205                                 pixel.<a class="code" href="classCPoint2D.html#a15">Set</a>(x,y);
00206                                 this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a12">RemovePixelRange</a>(pixel, Thickness);
00207                         }
00208                 }
00209         }
00210 }
00211 
00212 
<a name="l00213"></a><a class="code" href="classipl_1_1CBinaryImage.html#a14">00213</a> <span class="keywordtype">void</span> CBinaryImage::RemoveLine2(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a>&amp; p, <span class="keywordtype">int</span> Thickness) {
00214    <span class="keywordtype">float</span> C = (float) cos(p.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00215    <span class="keywordtype">float</span> S = (float) sin(p.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00216    <span class="keywordtype">float</span> rho = p.<a class="code" href="classCPoint2D.html#a14">GetY</a>()-Thickness;;
00217    <span class="keywordtype">int</span> x, y;
00218    <a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a> pixel;
00219 
00220    <span class="keywordflow">while</span> (rho&lt;=p.<a class="code" href="classCPoint2D.html#a14">GetY</a>()+Thickness) {
00221 
00222       <span class="keywordflow">if</span> (p.<a class="code" href="classCPoint2D.html#a13">GetX</a>() == 0.0f) {
00223          <span class="keywordflow">for</span> (y=-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>(); y&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>(); y++) {
00224             x = <a class="code" href="group__templates.html#a6">Round</a>((rho - y*S) / C);
00225             <span class="keywordflow">if</span> (-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;=x &amp;&amp; x&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()) {
00226                pixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>(x);
00227                pixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>(y);
00228                this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a11">RemovePixelFast</a>(pixel);
00229             }
00230          }
00231       } <span class="keywordflow">else</span> {
00232          <span class="keywordflow">for</span> (x=-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>(); x&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>(); x++) {
00233             y = <a class="code" href="group__templates.html#a6">Round</a>((rho - x*C) / S);
00234             <span class="keywordflow">if</span> (-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;=y &amp;&amp; y&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()) {
00235                pixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>(x);
00236                pixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>(y);
00237                this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a11">RemovePixelFast</a>(pixel);
00238             }
00239          }
00240       }
00241 
00242       rho+=0.25;
00243    }
00244 }
00245 
00246 
<a name="l00247"></a><a class="code" href="classipl_1_1CBinaryImage.html#a19">00247</a> <span class="keywordtype">void</span> CBinaryImage::AddLine(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a>&amp; p)
00248 {
00249    <a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a> pixel;
00250    vector&lt;int&gt; points = this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a21">ComputeIntersectionPoints</a>(p);
00251    <span class="keywordtype">int</span> dist = (int) sqrt(pow(points[0]-points[2],2.0)+pow(points[1]-points[3],2.0));
00252    cout &lt;&lt; <span class="stringliteral">"DIST: "</span> &lt;&lt; dist &lt;&lt; endl;
00253 
00254    <span class="keywordtype">float</span> xi, yi, dx, dy;
00255 
00256    xi = points[0]; 
00257    yi = points[1];
00258    dx = (1.0f*points[2]-points[0])/dist;
00259    dy = (1.0f*points[3]-points[1])/dist;
00260 
00261    <span class="keywordflow">while</span> (dist &gt; 0) {
00262       xi += dx;
00263       yi += dy;
00264       <span class="keywordflow">if</span> (-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;=xi &amp;&amp; xi&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; 
00265           -m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;=yi &amp;&amp; yi&lt;m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>()) {
00266          pixel.<a class="code" href="classCPoint2D.html#a16">SetX</a>((<span class="keywordtype">int</span>) xi);
00267          pixel.<a class="code" href="classCPoint2D.html#a17">SetY</a>((<span class="keywordtype">int</span>) yi);
00268          m_coord.push_back(pixel);
00269       }
00270       dist--;
00271    }
00272 }
00273 
00274 
<a name="l00275"></a><a class="code" href="classipl_1_1CBinaryImage.html#a20">00275</a> <span class="keywordtype">void</span> CBinaryImage::AddCircle(<span class="keyword">const</span> <a class="code" href="classCPoint3D.html">CPoint3D&lt;float&gt;</a>&amp; p) {
00276    <span class="keywordtype">int</span> perimeter = (int) 2*PI*p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00277    <span class="keywordtype">float</span> theta = 0.0f;
00278    <span class="keywordtype">float</span> dt = 1/p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00279    <span class="keywordtype">int</span> x, y, z, xi, yi;
00280    x = p.<a class="code" href="classCPoint3D.html#a15">GetX</a>();
00281    y = p.<a class="code" href="classCPoint3D.html#a16">GetY</a>();
00282    z = p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00283 
00284    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;perimeter; i++) {
00285       xi = x + z*cos(theta);
00286       yi = y + z*sin(theta);
00287       theta+=dt;
00288       this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a17">AddPixel</a>(<a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a>(xi,yi));
00289    }
00290 }
00291 
00292 
<a name="l00293"></a><a class="code" href="classipl_1_1CBinaryImage.html#a15">00293</a> <span class="keywordtype">void</span> CBinaryImage::RemoveCircle(<span class="keyword">const</span> <a class="code" href="classCPoint3D.html">CPoint3D&lt;float&gt;</a>&amp; p) {
00294    <span class="keywordtype">int</span> perimeter = (int) 2*PI*p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00295    <span class="keywordtype">float</span> theta = 0.0f;
00296    <span class="keywordtype">float</span> dt = 1/p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00297    <span class="keywordtype">int</span> x, y, z, xi, yi;
00298    x = p.<a class="code" href="classCPoint3D.html#a15">GetX</a>();
00299    y = p.<a class="code" href="classCPoint3D.html#a16">GetY</a>();
00300    z = p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>();
00301 
00302    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;perimeter; i++) {
00303       xi = x + z*cos(theta);
00304       yi = y + z*sin(theta);
00305       theta+=dt;
00306       <a class="code" href="classipl_1_1CBinaryImage.html#a9">RemovePixel</a>(<a class="code" href="classCParameter2D.html">CParameter2D&lt;int&gt;</a>(xi,yi));
00307    }
00308 }
00309 
00310 
<a name="l00311"></a><a class="code" href="classipl_1_1CBinaryImage.html#a16">00311</a> <span class="keywordtype">void</span> CBinaryImage::RemoveCircleRange(<span class="keyword">const</span> <a class="code" href="classCPoint3D.html">CPoint3D&lt;float&gt;</a>&amp; p, <span class="keywordtype">int</span> i) {
00312    <a class="code" href="classCPoint3D.html">CPoint3D&lt;float&gt;</a> q(p);
00313    <span class="keywordtype">int</span> r;
00314    <span class="keywordflow">for</span> (r = p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>()-i; r&lt;=p.<a class="code" href="classCPoint3D.html#a17">GetZ</a>()+i; r++) {
00315       <span class="keywordflow">if</span> (r &gt; 0) {
00316          q.<a class="code" href="classCPoint3D.html#a21">SetZ</a>(r);
00317          this-&gt;<a class="code" href="classipl_1_1CBinaryImage.html#a15">RemoveCircle</a>(q);
00318       }
00319    }
00320 }
00321 
00322 
<a name="l00323"></a><a class="code" href="classipl_1_1CBinaryImage.html#a21">00323</a> vector&lt;int&gt; CBinaryImage::ComputeIntersectionPoints(<span class="keyword">const</span> <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a>&amp; p) {
00324    <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a>  left_line(0.0f,  m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00325    <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a> right_line((<span class="keywordtype">float</span>) PI,   m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00326    <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a> lower_line((<span class="keywordtype">float</span>) PI/2, m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00327    <a class="code" href="classCParameter2D.html">CParameter2D&lt;float&gt;</a> upper_line((<span class="keywordtype">float</span>) PI*3/2, m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00328 
00329    <a class="code" href="classCPoint2D.html">CPoint2D&lt;float&gt;</a> left_intersection = left_line.<a class="code" href="classCParameter2D.html#z7_2">NormalLineIntersection</a>(p);
00330    <a class="code" href="classCPoint2D.html">CPoint2D&lt;float&gt;</a> right_intersection = right_line.<a class="code" href="classCParameter2D.html#z7_2">NormalLineIntersection</a>(p);
00331    <a class="code" href="classCPoint2D.html">CPoint2D&lt;float&gt;</a> lower_intersection = lower_line.<a class="code" href="classCParameter2D.html#z7_2">NormalLineIntersection</a>(p);
00332    <a class="code" href="classCPoint2D.html">CPoint2D&lt;float&gt;</a> upper_intersection = upper_line.<a class="code" href="classCParameter2D.html#z7_2">NormalLineIntersection</a>(p);
00333 
00334    <a class="code" href="classCPoint2D.html">CPoint2D&lt;float&gt;</a> p1, p2;
00335 
00336    <span class="keywordtype">int</span> left = 2;
00337 
00338    <span class="keywordflow">if</span>(left_intersection.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&gt;=-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>() &amp;&amp; 
00339       left_intersection.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;=m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>() &amp;&amp; left&gt;0) {
00340       p1 = left_intersection;
00341       left--;
00342       <span class="comment">//cout &lt;&lt; "found LEFT" &lt;&lt; endl;</span>
00343    }
00344    <span class="keywordflow">if</span>(right_intersection.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&gt;=-m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>() &amp;&amp; 
00345       right_intersection.<a class="code" href="classCPoint2D.html#a14">GetY</a>()&lt;=m_originPosition.<a class="code" href="classCPoint2D.html#a14">GetY</a>() &amp;&amp; left&gt;0) { 
00346       <span class="keywordflow">if</span> (left == 2) {
00347          p1 = right_intersection;
00348       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left == 1) {
00349          p2 = right_intersection;
00350       }
00351       left--;
00352       <span class="comment">//cout &lt;&lt; "found RIGHT" &lt;&lt; endl;</span>
00353    }
00354    <span class="keywordflow">if</span>(lower_intersection.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&gt;=-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; 
00355       lower_intersection.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;=m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; left&gt;0) {
00356       <span class="keywordflow">if</span> (left == 2) {
00357          p1 = lower_intersection;
00358       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left == 1) {
00359          p2 = lower_intersection;
00360       }
00361       left--;
00362       <span class="comment">//cout &lt;&lt; "found LOWER" &lt;&lt; endl;</span>
00363    }
00364    <span class="keywordflow">if</span>(upper_intersection.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&gt;=-m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; 
00365       upper_intersection.<a class="code" href="classCPoint2D.html#a13">GetX</a>()&lt;=m_originPosition.<a class="code" href="classCPoint2D.html#a13">GetX</a>() &amp;&amp; left&gt;0) {
00366       p2 = upper_intersection;
00367       left--;
00368       <span class="comment">//cout &lt;&lt; "found UPPER" &lt;&lt; endl;</span>
00369    }
00370 
00371    <span class="comment">//cout &lt;&lt; "P1 " &lt;&lt; p1 &lt;&lt; endl;</span>
00372    <span class="comment">//cout &lt;&lt; "P2 " &lt;&lt; p2 &lt;&lt; endl;</span>
00373 
00374    vector&lt;int&gt; points;
00375    points.push_back((<span class="keywordtype">int</span>) p1.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00376    points.push_back((<span class="keywordtype">int</span>) p1.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00377    points.push_back((<span class="keywordtype">int</span>) p2.<a class="code" href="classCPoint2D.html#a13">GetX</a>());
00378    points.push_back((<span class="keywordtype">int</span>) p2.<a class="code" href="classCPoint2D.html#a14">GetY</a>());
00379    <span class="keywordflow">return</span> points;
00380 }
00381 
00382 
<a name="l00383"></a><a class="code" href="classipl_1_1CBinaryImage.html#a23">00383</a> CHoughBase::ORIGINTYPE CBinaryImage::GetOrigin()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_origin; }
00384 
00385 
00387 <span class="comment">// Private methods</span>
00389 <span class="comment"></span>
00390 
00391 <span class="keywordtype">void</span> CBinaryImage::SetOrigin(CHoughBase::ORIGINTYPE OriginType) {
00392    m_origin = OriginType;
00393 
00394    <span class="keywordtype">int</span> x, y, xd, yd;
00395    <span class="keywordflow">switch</span>(OriginType) {
00396    <span class="keywordflow">case</span> CHoughBase::LEFT_UPPER:
00397       x = 0;
00398       y = 0;
00399       xd = 1;
00400       yd = 1;
00401       <span class="keywordflow">break</span>;
00402    <span class="keywordflow">case</span> CHoughBase::CENTER_UP:
00403       x = (int) m_width/2;
00404       y = (int) m_height/2;
00405       xd = 1;
00406       yd = -1;
00407       <span class="keywordflow">break</span>;
00408    <span class="keywordflow">case</span> CHoughBase::CENTER_DOWN:
00409       x = (int) m_width/2;
00410       y = (int) m_height/2;
00411       xd = 1;
00412       yd = 1;
00413       <span class="keywordflow">break</span>;
00414    <span class="keywordflow">default</span>:
00415       x = (int) m_width/2;
00416       y = (int) m_height/2;
00417       xd = 1;
00418       yd = -1;
00419       <span class="keywordflow">break</span>;
00420    }
00421  
00422    m_originPosition.<a class="code" href="classCPoint2D.html#a16">SetX</a>(x);
00423    m_originPosition.<a class="code" href="classCPoint2D.html#a17">SetY</a>(y);
00424    m_originOrientation.<a class="code" href="classCPoint2D.html#a16">SetX</a>(xd);
00425    m_originOrientation.<a class="code" href="classCPoint2D.html#a17">SetY</a>(yd);
00426 }
00427 
00428 } <span class="comment">// end namespace ipl</span>
</pre></div><!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<title>Tag</title>
<base target="_top">
</head>

<body bgcolor="#FFFFFF">

<hr>

<p align="right"><font size="2"><em>Updated <!--webbot bot="Timestamp" s-type="EDITED" s-format="%d. %B %Y %H:%M" startspan -->21. juli 2002 12:29<!--webbot bot="Timestamp" endspan i-checksum="38834" --> by
<a href="http://www.mip.sdu.dk/~edr/">René Dencker
Eriksen</a>(<a href="mailto:edr@mip.sdu.dk">edr@mip.sdu.dk</a>)</em></font></p>
</body>
</html>
